<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stephen Barrie">
<meta name="dcterms.date" content="2022-12-05">

<title>Into the Unknown - Wisła Kraków vs.&nbsp;KS Cracovia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Into the Unknown</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">Stephen Barrie</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Stephen137" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/sjbarrie" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Wisła Kraków vs.&nbsp;KS Cracovia</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Projects</div>
                <div class="quarto-category">SQL</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Stephen Barrie </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 5, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#project-idea" id="toc-project-idea" class="nav-link active" data-scroll-target="#project-idea">Project idea</a></li>
  <li><a href="#european-soccer-database" id="toc-european-soccer-database" class="nav-link" data-scroll-target="#european-soccer-database">European Soccer Database</a></li>
  <li><a href="#joining-data-using-sql" id="toc-joining-data-using-sql" class="nav-link" data-scroll-target="#joining-data-using-sql">Joining data using SQL</a></li>
  <li><a href="#query-run-order" id="toc-query-run-order" class="nav-link" data-scroll-target="#query-run-order">Query Run Order</a></li>
  <li><a href="#sub-queries-and-functions" id="toc-sub-queries-and-functions" class="nav-link" data-scroll-target="#sub-queries-and-functions">Sub Queries and Functions</a></li>
  <li><a href="#accessing-sqlite-databases-using-python-and-pandas" id="toc-accessing-sqlite-databases-using-python-and-pandas" class="nav-link" data-scroll-target="#accessing-sqlite-databases-using-python-and-pandas">Accessing SQLite Databases Using Python and Pandas</a>
  <ul class="collapse">
  <li><a href="#the-sqlite3-module" id="toc-the-sqlite3-module" class="nav-link" data-scroll-target="#the-sqlite3-module">The sqlite3 module</a></li>
  </ul></li>
  <li><a href="#table-1---country" id="toc-table-1---country" class="nav-link" data-scroll-target="#table-1---country">Table 1 - Country</a></li>
  <li><a href="#table-2---league" id="toc-table-2---league" class="nav-link" data-scroll-target="#table-2---league">Table 2 - League</a></li>
  <li><a href="#table-3---match" id="toc-table-3---match" class="nav-link" data-scroll-target="#table-3---match">Table 3 - Match</a></li>
  <li><a href="#table-4---player" id="toc-table-4---player" class="nav-link" data-scroll-target="#table-4---player">Table 4 - Player</a></li>
  <li><a href="#table-5---player-attributes" id="toc-table-5---player-attributes" class="nav-link" data-scroll-target="#table-5---player-attributes">Table 5 - Player attributes</a></li>
  <li><a href="#table-6---teams" id="toc-table-6---teams" class="nav-link" data-scroll-target="#table-6---teams">Table 6 - Teams</a></li>
  <li><a href="#table-7---team-attributes" id="toc-table-7---team-attributes" class="nav-link" data-scroll-target="#table-7---team-attributes">Table 7 - Team attributes</a></li>
  <li><a href="#which-polish-teams-are-included-in-the-database" id="toc-which-polish-teams-are-included-in-the-database" class="nav-link" data-scroll-target="#which-polish-teams-are-included-in-the-database">Which Polish teams are included in the database?</a></li>
  <li><a href="#the-holy-war---święta-wojna" id="toc-the-holy-war---święta-wojna" class="nav-link" data-scroll-target="#the-holy-war---święta-wojna">The Holy War - Święta Wojna</a></li>
  <li><a href="#wisła-kraków" id="toc-wisła-kraków" class="nav-link" data-scroll-target="#wisła-kraków">Wisła Kraków</a>
  <ul class="collapse">
  <li><a href="#to-20152016" id="toc-to-20152016" class="nav-link" data-scroll-target="#to-20152016">2008/2009 to 2015/2016</a></li>
  <li><a href="#to-20212022" id="toc-to-20212022" class="nav-link" data-scroll-target="#to-20212022">2016/2017 to 2021/2022</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">2022/2023</a></li>
  </ul></li>
  <li><a href="#ks-cracovia" id="toc-ks-cracovia" class="nav-link" data-scroll-target="#ks-cracovia">KS Cracovia</a>
  <ul class="collapse">
  <li><a href="#to-20152016-1" id="toc-to-20152016-1" class="nav-link" data-scroll-target="#to-20152016-1">2008/2009 to 2015/2016</a></li>
  <li><a href="#to-20212022-1" id="toc-to-20212022-1" class="nav-link" data-scroll-target="#to-20212022-1">2016/2017 to 2021/2022</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2022/2023</a></li>
  </ul></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key takeaways</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="project-idea" class="level3">
<h3 class="anchored" data-anchor-id="project-idea">Project idea</h3>
<p>I arrived in Kraków a few months back and during my wanderings I noticed two football stadiums on either side of <a href="https://pl.wikipedia.org/wiki/B%C5%82onia_(Krak%C3%B3w)">Błonia</a> separated by just 700 metres. I didn’t know anything about either of these clubs but was told that the rivalry between them is intense. The so-called Holy War between Wisła Kraków and KS Cracovia has even featured in documentaries by Ross Kemp and Danny Dyer.</p>
<p>I thought I would try to use <a href="https://en.wikipedia.org/wiki/SQL">Structured Query Language</a> more commonly known as SQL to find out a bit more. To get the ball rolling I first needed to find a data source.</p>
</section>
<section id="european-soccer-database" class="level3">
<h3 class="anchored" data-anchor-id="european-soccer-database">European Soccer Database</h3>
<p>The <a href="https://www.kaggle.com/datasets/hugomathien/soccer">European Soccer Database</a> includes:</p>
<ul>
<li>+25,000 matches</li>
<li>+10,000 players</li>
<li>11 European Countries with their lead championship</li>
<li>Seasons 2008 to 2016</li>
<li>Players and Teams’ attributes* sourced from EA Sports’ FIFA video game series, including the weekly updates</li>
<li>Team line up with squad formation (X, Y coordinates)</li>
<li>Betting odds from up to 10 providers</li>
<li>Detailed match events (goal types, possession, corner, cross, fouls, cards etc…) for +10,000 matches</li>
</ul>
<p>The information is spread across 7 tables:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Krakow_Football_files/figure-html/29324eb3-4d46-4a00-ac8a-2516624c2409-1-77570cab-8f81-4205-b8af-d0fa65cb15dd.PNG" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">database_tables.PNG</figcaption>
</figure>
</div>
<p>A very helpful diagram of the database schema is included below, as provided by <a href="https://github.com/fmahlmeister">Felipe Mahlmeister</a>. This shows the links between the tables which will help us construct the appropriate JOIN queries to get the information we need.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Krakow_Football_files/figure-html/063411f0-2865-4e08-bf1a-cfd3f68108d5-1-c1627504-4c14-44b0-b5ee-06d36c82dc6a.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">metadata.png</figcaption>
</figure>
</div>
</section>
<section id="joining-data-using-sql" class="level3">
<h3 class="anchored" data-anchor-id="joining-data-using-sql">Joining data using SQL</h3>
<p>JOIN is used when you want to connect two tables to each other. It works when you have a common key in each of them. Understanding the concept of Keys is crucial for connecting (joining) between datasets (tables). A key is uniquely identifies each record (row) in a table. It can consinst of one value (cell) - usually ID, or from a combination of values that are unique in the table.</p>
<p>When joining between different tables, you must:</p>
<ul>
<li><p>Decide what type of join to use. The most common are:</p>
<ul>
<li>(INNER) JOIN - keep only records that match the condition (after the ON) in both the tables, and records in both tables that do not match wouldn’t appear in the output</li>
<li>LEFT JOIN - keep all the values from the first (left) table - in conjunction with the matching rows from the right table. The columns from the right table, that don’t have a matching value in the left, would have NULL values.</li>
</ul></li>
<li><p>Specify the common value that is used to connect the tables (the ID of the country in that case).</p></li>
<li><p>Make sure that at least one of the values is a key in its table. In our case, it’s the Country.id. The League.country_id is not unique, as there can be more than one league in the same country</p></li>
</ul>
<p>JOINs, and using them incorrectly, is the most common and dangerous mistake when writing complicated queries.</p>
</section>
<section id="query-run-order" class="level3">
<h3 class="anchored" data-anchor-id="query-run-order">Query Run Order</h3>
<p>It is very important to understand the order in which SQL code runs:</p>
<ul>
<li>SELECT</li>
<li>FROM</li>
<li>JOIN</li>
<li>WHERE</li>
<li>GROUP BY</li>
<li>HAVING</li>
<li>ORDER BY</li>
<li>LIMIT</li>
</ul>
<p>You can think of it as a two part process: First, create a new temporary table in the memory:</p>
<ul>
<li>Define which tables to use, and connect them (FROM + JOIN)</li>
<li>Keep only the rows that apply to the conditions (WHERE)</li>
<li>Group the data by the required level (if need) (GROUP BY)</li>
<li>Order the output of the new table (ORDER BY)</li>
<li>Add more conditions that would filter the new created table (HAVING)</li>
<li>Limit to a number of rows - based on the sorting and the having filtering (LIMIT)</li>
</ul>
</section>
<section id="sub-queries-and-functions" class="level3">
<h3 class="anchored" data-anchor-id="sub-queries-and-functions">Sub Queries and Functions</h3>
<p>Using subqueries is an essential tool in SQL, as it allows the manipulation of data in advanced ways without the need of any external scripts, and is especially important when tables are structured in such a way that they can’t be joined directly.</p>
<p>Once tables have the same keys, we can join them together (think of the subquery as any other table, only temporary), knowing that we won’t have duplicated rows after the join.</p>
<p>Conditional functions are an important tool for data manipulation. While the IF statement is very popular in other languages, SQLite does not support it, and instead uses CASE + WHEN + ELSE statements.</p>
</section>
<section id="accessing-sqlite-databases-using-python-and-pandas" class="level2">
<h2 class="anchored" data-anchor-id="accessing-sqlite-databases-using-python-and-pandas">Accessing SQLite Databases Using Python and Pandas</h2>
<p>After downloading the database file which is in .sqlite format. my first question was:</p>
<ul>
<li>is it even possible to work with database data using Python within Jupyter Notebooks?</li>
</ul>
<p>The good news is, yes it is possible :) After quite a bit of digging I found <a href="https://datacarpentry.org/python-ecology-lesson/09-working-with-sql/index.html">this article</a> which gave me a platform to make a start on this project idea.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install the required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-sqlite3-module" class="level3">
<h3 class="anchored" data-anchor-id="the-sqlite3-module">The sqlite3 module</h3>
<p>SQLite is a C library that provides a lightweight disk-based database that doesn’t require a separate server process and allows accessing the database using a nonstandard variant of the SQL query language. Some applications can use SQLite for internal data storage. It’s also possible to prototype an application using SQLite and then port the code to a larger database such as PostgreSQL or Oracle.</p>
<p>The <a href="https://docs.python.org/3/library/sqlite3.html">sqlite3 module</a> was written by Gerhard Häring and provides an SQL interface compliant with the DB-API 2.0 specification described by PEP 249, and requires SQLite 3.7.15 or newer.</p>
<div class="cell" data-tags="[]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a SQL connection to our downloaded SQLite database file</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"Data/database.sqlite"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Basically you can run SQL queries just as you would within a database, and then convert the results to a pandas DataFrame for further analysis and presentation. Let’s have a look at each of the 7 tables in turn to establish what sort of information is included:</p>
</section>
</section>
<section id="table-1---country" class="level2">
<h2 class="anchored" data-anchor-id="table-1---country">Table 1 - Country</h2>
<div class="cell" data-execution_count="318">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pandas DataFRame of the Country table</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>country <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT * </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">                            FROM Country'''</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                            ,con)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       id         name
0       1      Belgium
1    1729      England
2    4769       France
3    7809      Germany
4   10257        Italy
5   13274  Netherlands
6   15722       Poland
7   17642     Portugal
8   19694     Scotland
9   21518        Spain
10  24558  Switzerland</code></pre>
</div>
</div>
<p>So, the database covers 11 countries and the country id for Poland is 15722.</p>
</section>
<section id="table-2---league" class="level2">
<h2 class="anchored" data-anchor-id="table-2---league">Table 2 - League</h2>
<div class="cell" data-execution_count="319">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pandas DataFrame of the League table</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>leagues <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT * </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">                            FROM League'''</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                            ,con)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(leagues)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       id  country_id                      name
0       1           1    Belgium Jupiler League
1    1729        1729    England Premier League
2    4769        4769            France Ligue 1
3    7809        7809     Germany 1. Bundesliga
4   10257       10257             Italy Serie A
5   13274       13274    Netherlands Eredivisie
6   15722       15722        Poland Ekstraklasa
7   17642       17642  Portugal Liga ZON Sagres
8   19694       19694   Scotland Premier League
9   21518       21518           Spain LIGA BBVA
10  24558       24558  Switzerland Super League</code></pre>
</div>
</div>
<p>And, the id for the League name is the same as the country_id - for the Polish Ekstraklasa this is 15722.</p>
</section>
<section id="table-3---match" class="level2">
<h2 class="anchored" data-anchor-id="table-3---match">Table 3 - Match</h2>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pandas DataFrame of the Match table</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>matches <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT * </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="st">                            FROM Match'''</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                            ,con)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>matches.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">country_id</th>
<th data-quarto-table-cell-role="th">league_id</th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">stage</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">match_api_id</th>
<th data-quarto-table-cell-role="th">home_team_api_id</th>
<th data-quarto-table-cell-role="th">away_team_api_id</th>
<th data-quarto-table-cell-role="th">home_team_goal</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">SJA</th>
<th data-quarto-table-cell-role="th">VCH</th>
<th data-quarto-table-cell-role="th">VCD</th>
<th data-quarto-table-cell-role="th">VCA</th>
<th data-quarto-table-cell-role="th">GBH</th>
<th data-quarto-table-cell-role="th">GBD</th>
<th data-quarto-table-cell-role="th">GBA</th>
<th data-quarto-table-cell-role="th">BSH</th>
<th data-quarto-table-cell-role="th">BSD</th>
<th data-quarto-table-cell-role="th">BSA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2008/2009</td>
<td>1</td>
<td>2008-08-17 00:00:00</td>
<td>492473</td>
<td>9987</td>
<td>9993</td>
<td>1</td>
<td>...</td>
<td>4.00</td>
<td>1.65</td>
<td>3.40</td>
<td>4.50</td>
<td>1.78</td>
<td>3.25</td>
<td>4.00</td>
<td>1.73</td>
<td>3.40</td>
<td>4.20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2008/2009</td>
<td>1</td>
<td>2008-08-16 00:00:00</td>
<td>492474</td>
<td>10000</td>
<td>9994</td>
<td>0</td>
<td>...</td>
<td>3.80</td>
<td>2.00</td>
<td>3.25</td>
<td>3.25</td>
<td>1.85</td>
<td>3.25</td>
<td>3.75</td>
<td>1.91</td>
<td>3.25</td>
<td>3.60</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>2008/2009</td>
<td>1</td>
<td>2008-08-16 00:00:00</td>
<td>492475</td>
<td>9984</td>
<td>8635</td>
<td>0</td>
<td>...</td>
<td>2.50</td>
<td>2.35</td>
<td>3.25</td>
<td>2.65</td>
<td>2.50</td>
<td>3.20</td>
<td>2.50</td>
<td>2.30</td>
<td>3.20</td>
<td>2.75</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>2008/2009</td>
<td>1</td>
<td>2008-08-17 00:00:00</td>
<td>492476</td>
<td>9991</td>
<td>9998</td>
<td>5</td>
<td>...</td>
<td>7.50</td>
<td>1.45</td>
<td>3.75</td>
<td>6.50</td>
<td>1.50</td>
<td>3.75</td>
<td>5.50</td>
<td>1.44</td>
<td>3.75</td>
<td>6.50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>1</td>
<td>1</td>
<td>2008/2009</td>
<td>1</td>
<td>2008-08-16 00:00:00</td>
<td>492477</td>
<td>7947</td>
<td>9985</td>
<td>1</td>
<td>...</td>
<td>1.73</td>
<td>4.50</td>
<td>3.40</td>
<td>1.65</td>
<td>4.50</td>
<td>3.50</td>
<td>1.65</td>
<td>4.75</td>
<td>3.30</td>
<td>1.67</td>
</tr>
</tbody>
</table>

<p>5 rows × 115 columns</p>
</div>
</div>
</div>
<p>As you can see we have a LOT of data here - 115 columns! Let’s focus on the <strong><em>season</em></strong> column for the moment. From the first 5 rows we can see that we have information starting from the 2008/2009 season. Let’s check how many seasons we have data for:</p>
<div class="cell" data-execution_count="321">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>matches.season.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="321">
<pre><code>array(['2008/2009', '2009/2010', '2010/2011', '2011/2012', '2012/2013',
       '2013/2014', '2014/2015', '2015/2016'], dtype=object)</code></pre>
</div>
</div>
</section>
<section id="table-4---player" class="level2">
<h2 class="anchored" data-anchor-id="table-4---player">Table 4 - Player</h2>
<div class="cell" data-execution_count="322">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>players <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT * </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">                            FROM Player'''</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                            ,con)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(players)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          id  player_api_id          player_name  player_fifa_api_id  \
0          1         505942   Aaron Appindangoye              218353   
1          2         155782      Aaron Cresswell              189615   
2          3         162549          Aaron Doran              186170   
3          4          30572        Aaron Galindo              140161   
4          5          23780         Aaron Hughes               17725   
...      ...            ...                  ...                 ...   
11055  11071          26357       Zoumana Camara                2488   
11056  11072         111182         Zsolt Laczko              164680   
11057  11073          36491            Zsolt Low              111191   
11058  11074          35506  Zurab Khizanishvili               47058   
11059  11075          39902   Zvjezdan Misimovic              102359   

                  birthday  height  weight  
0      1992-02-29 00:00:00  182.88     187  
1      1989-12-15 00:00:00  170.18     146  
2      1991-05-13 00:00:00  170.18     163  
3      1982-05-08 00:00:00  182.88     198  
4      1979-11-08 00:00:00  182.88     154  
...                    ...     ...     ...  
11055  1979-04-03 00:00:00  182.88     168  
11056  1986-12-18 00:00:00  182.88     176  
11057  1979-04-29 00:00:00  180.34     154  
11058  1981-10-06 00:00:00  185.42     172  
11059  1982-06-05 00:00:00  180.34     176  

[11060 rows x 7 columns]</code></pre>
</div>
</div>
</section>
<section id="table-5---player-attributes" class="level2">
<h2 class="anchored" data-anchor-id="table-5---player-attributes">Table 5 - Player attributes</h2>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>player_attributes <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT * </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="st">                                      FROM Player_Attributes'''</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                                      ,con)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>player_attributes.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">player_fifa_api_id</th>
<th data-quarto-table-cell-role="th">player_api_id</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">overall_rating</th>
<th data-quarto-table-cell-role="th">potential</th>
<th data-quarto-table-cell-role="th">preferred_foot</th>
<th data-quarto-table-cell-role="th">attacking_work_rate</th>
<th data-quarto-table-cell-role="th">defensive_work_rate</th>
<th data-quarto-table-cell-role="th">crossing</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">vision</th>
<th data-quarto-table-cell-role="th">penalties</th>
<th data-quarto-table-cell-role="th">marking</th>
<th data-quarto-table-cell-role="th">standing_tackle</th>
<th data-quarto-table-cell-role="th">sliding_tackle</th>
<th data-quarto-table-cell-role="th">gk_diving</th>
<th data-quarto-table-cell-role="th">gk_handling</th>
<th data-quarto-table-cell-role="th">gk_kicking</th>
<th data-quarto-table-cell-role="th">gk_positioning</th>
<th data-quarto-table-cell-role="th">gk_reflexes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>218353</td>
<td>505942</td>
<td>2016-02-18 00:00:00</td>
<td>67.0</td>
<td>71.0</td>
<td>right</td>
<td>medium</td>
<td>medium</td>
<td>49.0</td>
<td>...</td>
<td>54.0</td>
<td>48.0</td>
<td>65.0</td>
<td>69.0</td>
<td>69.0</td>
<td>6.0</td>
<td>11.0</td>
<td>10.0</td>
<td>8.0</td>
<td>8.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>218353</td>
<td>505942</td>
<td>2015-11-19 00:00:00</td>
<td>67.0</td>
<td>71.0</td>
<td>right</td>
<td>medium</td>
<td>medium</td>
<td>49.0</td>
<td>...</td>
<td>54.0</td>
<td>48.0</td>
<td>65.0</td>
<td>69.0</td>
<td>69.0</td>
<td>6.0</td>
<td>11.0</td>
<td>10.0</td>
<td>8.0</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>218353</td>
<td>505942</td>
<td>2015-09-21 00:00:00</td>
<td>62.0</td>
<td>66.0</td>
<td>right</td>
<td>medium</td>
<td>medium</td>
<td>49.0</td>
<td>...</td>
<td>54.0</td>
<td>48.0</td>
<td>65.0</td>
<td>66.0</td>
<td>69.0</td>
<td>6.0</td>
<td>11.0</td>
<td>10.0</td>
<td>8.0</td>
<td>8.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>218353</td>
<td>505942</td>
<td>2015-03-20 00:00:00</td>
<td>61.0</td>
<td>65.0</td>
<td>right</td>
<td>medium</td>
<td>medium</td>
<td>48.0</td>
<td>...</td>
<td>53.0</td>
<td>47.0</td>
<td>62.0</td>
<td>63.0</td>
<td>66.0</td>
<td>5.0</td>
<td>10.0</td>
<td>9.0</td>
<td>7.0</td>
<td>7.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>218353</td>
<td>505942</td>
<td>2007-02-22 00:00:00</td>
<td>61.0</td>
<td>65.0</td>
<td>right</td>
<td>medium</td>
<td>medium</td>
<td>48.0</td>
<td>...</td>
<td>53.0</td>
<td>47.0</td>
<td>62.0</td>
<td>63.0</td>
<td>66.0</td>
<td>5.0</td>
<td>10.0</td>
<td>9.0</td>
<td>7.0</td>
<td>7.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 42 columns</p>
</div>
</div>
</div>
</section>
<section id="table-6---teams" class="level2">
<h2 class="anchored" data-anchor-id="table-6---teams">Table 6 - Teams</h2>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pandas DataFRame of the Team table</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>teams <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT * </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="st">                          FROM Team'''</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                          ,con)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(teams)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        id  team_api_id  team_fifa_api_id      team_long_name team_short_name
0        1         9987             673.0            KRC Genk             GEN
1        2         9993             675.0        Beerschot AC             BAC
2        3        10000           15005.0    SV Zulte-Waregem             ZUL
3        4         9994            2007.0    Sporting Lokeren             LOK
4        5         9984            1750.0   KSV Cercle Brugge             CEB
..     ...          ...               ...                 ...             ...
294  49479        10190             898.0       FC St. Gallen             GAL
295  49837        10191            1715.0             FC Thun             THU
296  50201         9777             324.0         Servette FC             SER
297  50204         7730            1862.0  FC Lausanne-Sports             LAU
298  51606         7896               NaN              Lugano             LUG

[299 rows x 5 columns]</code></pre>
</div>
</div>
<p>So we can see that the Team table has information about 299 teams. It would be useful to see the breakdown of the number of teams from each country league. It’s not possibe to do this using the information contained in the Team table alone. We will need to join two tables together to obtain this information:</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the Team table to the Match table using an INNER JOIN and create a pandas DataFrame</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>team_league <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT DISTINCT t.team_api_id AS team_id, t.team_long_name AS team_name, l.name AS league </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                FROM Team AS t </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="st">                                JOIN Match AS m ON t.team_api_id = m.home_team_api_id </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                JOIN League AS l ON l.country_id = m.country_id'''</span>,con)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>team_league.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">team_id</th>
<th data-quarto-table-cell-role="th">team_name</th>
<th data-quarto-table-cell-role="th">league</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1601</td>
<td>Ruch Chorzów</td>
<td>Poland Ekstraklasa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1773</td>
<td>Oud-Heverlee Leuven</td>
<td>Belgium Jupiler League</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1957</td>
<td>Jagiellonia Białystok</td>
<td>Poland Ekstraklasa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2033</td>
<td>S.C. Olhanense</td>
<td>Portugal Liga ZON Sagres</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2182</td>
<td>Lech Poznań</td>
<td>Poland Ekstraklasa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2183</td>
<td>P. Warszawa</td>
<td>Poland Ekstraklasa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2186</td>
<td>Cracovia</td>
<td>Poland Ekstraklasa</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>4049</td>
<td>Tubize</td>
<td>Belgium Jupiler League</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>4064</td>
<td>Feirense</td>
<td>Portugal Liga ZON Sagres</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>4087</td>
<td>Évian Thonon Gaillard FC</td>
<td>France Ligue 1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Great, now we have the required information to show the number of teams split across the 11 distinct leagues. Let’s use pandas to sort and group this data and then illustrate graphically using matplotlib:</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>title_string <span class="op">=</span> <span class="st">"European Soccer Database "</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>subtitle_string <span class="op">=</span> <span class="st">"Number of teams per country"</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> team_league.groupby(<span class="st">"league"</span>)[<span class="st">"team_name"</span>].count().sort_values(ascending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>x.plot(kind<span class="op">=</span><span class="st">'barh'</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>plt.suptitle(title_string, y<span class="op">=</span><span class="fl">1.05</span>, fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plt.title(subtitle_string, fontsize<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>Text(0.5, 1.0, 'Number of teams per country')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>team_league.groupby(<span class="st">"league"</span>)[<span class="st">"team_name"</span>].count().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>league
France Ligue 1              35
England Premier League      34
Spain LIGA BBVA             33
Italy Serie A               32
Germany 1. Bundesliga       30
Portugal Liga ZON Sagres    29
Belgium Jupiler League      25
Netherlands Eredivisie      25
Poland Ekstraklasa          24
Scotland Premier League     17
Switzerland Super League    15
Name: team_name, dtype: int64</code></pre>
</div>
</div>
<p>There is quite a disparity between the various leagues. The French Ligue 1 has 20 teams (we have data for 35 teams because the dataset covers 8 seasons and accounts for promotions from the lower leagues), whereas the Swiss Super League only has 10 teams.</p>
</section>
<section id="table-7---team-attributes" class="level2">
<h2 class="anchored" data-anchor-id="table-7---team-attributes">Table 7 - Team attributes</h2>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pandas DataFRame of the Team table</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>team_attributes<span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT * </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                   FROM Team_Attributes'''</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                   ,con)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>team_attributes.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">team_fifa_api_id</th>
<th data-quarto-table-cell-role="th">team_api_id</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">buildUpPlaySpeed</th>
<th data-quarto-table-cell-role="th">buildUpPlaySpeedClass</th>
<th data-quarto-table-cell-role="th">buildUpPlayDribbling</th>
<th data-quarto-table-cell-role="th">buildUpPlayDribblingClass</th>
<th data-quarto-table-cell-role="th">buildUpPlayPassing</th>
<th data-quarto-table-cell-role="th">buildUpPlayPassingClass</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">chanceCreationShooting</th>
<th data-quarto-table-cell-role="th">chanceCreationShootingClass</th>
<th data-quarto-table-cell-role="th">chanceCreationPositioningClass</th>
<th data-quarto-table-cell-role="th">defencePressure</th>
<th data-quarto-table-cell-role="th">defencePressureClass</th>
<th data-quarto-table-cell-role="th">defenceAggression</th>
<th data-quarto-table-cell-role="th">defenceAggressionClass</th>
<th data-quarto-table-cell-role="th">defenceTeamWidth</th>
<th data-quarto-table-cell-role="th">defenceTeamWidthClass</th>
<th data-quarto-table-cell-role="th">defenceDefenderLineClass</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>434</td>
<td>9930</td>
<td>2010-02-22 00:00:00</td>
<td>60</td>
<td>Balanced</td>
<td>NaN</td>
<td>Little</td>
<td>50</td>
<td>Mixed</td>
<td>...</td>
<td>55</td>
<td>Normal</td>
<td>Organised</td>
<td>50</td>
<td>Medium</td>
<td>55</td>
<td>Press</td>
<td>45</td>
<td>Normal</td>
<td>Cover</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>434</td>
<td>9930</td>
<td>2014-09-19 00:00:00</td>
<td>52</td>
<td>Balanced</td>
<td>48.0</td>
<td>Normal</td>
<td>56</td>
<td>Mixed</td>
<td>...</td>
<td>64</td>
<td>Normal</td>
<td>Organised</td>
<td>47</td>
<td>Medium</td>
<td>44</td>
<td>Press</td>
<td>54</td>
<td>Normal</td>
<td>Cover</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>434</td>
<td>9930</td>
<td>2015-09-10 00:00:00</td>
<td>47</td>
<td>Balanced</td>
<td>41.0</td>
<td>Normal</td>
<td>54</td>
<td>Mixed</td>
<td>...</td>
<td>64</td>
<td>Normal</td>
<td>Organised</td>
<td>47</td>
<td>Medium</td>
<td>44</td>
<td>Press</td>
<td>54</td>
<td>Normal</td>
<td>Cover</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>77</td>
<td>8485</td>
<td>2010-02-22 00:00:00</td>
<td>70</td>
<td>Fast</td>
<td>NaN</td>
<td>Little</td>
<td>70</td>
<td>Long</td>
<td>...</td>
<td>70</td>
<td>Lots</td>
<td>Organised</td>
<td>60</td>
<td>Medium</td>
<td>70</td>
<td>Double</td>
<td>70</td>
<td>Wide</td>
<td>Cover</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>77</td>
<td>8485</td>
<td>2011-02-22 00:00:00</td>
<td>47</td>
<td>Balanced</td>
<td>NaN</td>
<td>Little</td>
<td>52</td>
<td>Mixed</td>
<td>...</td>
<td>52</td>
<td>Normal</td>
<td>Organised</td>
<td>47</td>
<td>Medium</td>
<td>47</td>
<td>Press</td>
<td>52</td>
<td>Normal</td>
<td>Cover</td>
</tr>
</tbody>
</table>

<p>5 rows × 25 columns</p>
</div>
</div>
</div>
</section>
<section id="which-polish-teams-are-included-in-the-database" class="level2">
<h2 class="anchored" data-anchor-id="which-polish-teams-are-included-in-the-database">Which Polish teams are included in the database?</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Krakow_Football_files/figure-html/d8c5e604-a0d9-41da-99e1-bd5697f1869b-1-004f51d7-978b-4b35-9a3f-c7da366903e6.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">poland.jpg</figcaption>
</figure>
</div>
<div class="cell" data-execution_count="330">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subquery filtering list with IN</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>poland_league <span class="op">=</span> pd.read_sql_query (<span class="st">'''SELECT team_long_name, </span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                   team_short_name AS abbr, </span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="st">                                   team_api_id AS team_id </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                   FROM Team WHERE team_api_id </span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                   IN (SELECT home_team_api_id FROM Match WHERE country_id = 15722)'''</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                                   ,con)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>poland_league</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="330">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">team_long_name</th>
<th data-quarto-table-cell-role="th">abbr</th>
<th data-quarto-table-cell-role="th">team_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Ruch Chorzów</td>
<td>CHO</td>
<td>1601</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jagiellonia Białystok</td>
<td>BIA</td>
<td>1957</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Lech Poznań</td>
<td>POZ</td>
<td>2182</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>P. Warszawa</td>
<td>PWA</td>
<td>2183</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Cracovia</td>
<td>CKR</td>
<td>2186</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Górnik Łęczna</td>
<td>LEC</td>
<td>8019</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Polonia Bytom</td>
<td>GOR</td>
<td>8020</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Zagłębie Lubin</td>
<td>ZAG</td>
<td>8021</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Pogoń Szczecin</td>
<td>POG</td>
<td>8023</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Widzew Łódź</td>
<td>WID</td>
<td>8024</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Śląsk Wrocław</td>
<td>SLA</td>
<td>8025</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Zawisza Bydgoszcz</td>
<td>ZAW</td>
<td>8027</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Piast Gliwice</td>
<td>PIG</td>
<td>8028</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Lechia Gdańsk</td>
<td>LGD</td>
<td>8030</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Polonia Bytom</td>
<td>POB</td>
<td>8031</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Podbeskidzie Bielsko-Biała</td>
<td>POD</td>
<td>8033</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Odra Wodzisław</td>
<td>ODR</td>
<td>8242</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Widzew Łódź</td>
<td>LOD</td>
<td>8244</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Korona Kielce</td>
<td>KKI</td>
<td>8245</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Arka Gdynia</td>
<td>ARK</td>
<td>8322</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>GKS Bełchatów</td>
<td>BEL</td>
<td>8569</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Legia Warszawa</td>
<td>LEG</td>
<td>8673</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Wisła Kraków</td>
<td>WIS</td>
<td>10265</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Termalica Bruk-Bet Nieciecza</td>
<td>TBN</td>
<td>177361</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>One or two familiar names there, Lech Poznań, Legia Warszawa. Having recently relocated to Kraków the focus for the rest of this project will be on the two Kraków teams:</p>
<ul>
<li>Wisła Kraków</li>
<li>KS Cracovia</li>
</ul>
<p>The history of both clubs appears to be colourful. Cracovia received a 5 point deduction in 2020/2021 for alleged match-rigging dating back to 2003/2004, and <a href="https://ryanferguson.co.uk/blogs/football/wisla-krakow-scandal-hooligans-sharks-owners-blaszczykowski">this article</a> on the history of Wisła Kraków is an entertaining read!</p>
</section>
<section id="the-holy-war---święta-wojna" class="level2">
<h2 class="anchored" data-anchor-id="the-holy-war---święta-wojna">The Holy War - Święta Wojna</h2>
<p>The term “Holy War” refers to the intense rivalry between the two Kraków-based teams; Wisła Kraków and KS Cracovia. In 1906, the establishment of the two first Polish football clubs, Cracovia and Wisła, created a rivalry that now dates back more than 100 years. The term “Holy War” was first used to describe the rivalry of Kraków’s Jewish teams, Makkabi and Jutrzenka. A Jutrzenka defender, Ludwik Gintel, who later joined the Cracovia side referred to the derby match against Wisła as the “Holy War”. The phrase was incorporated into a song and has since been popular amongst both Wisła and Cracovia fans.</p>
<p>The first recorded Kraków Derby was contested on 20 September 1908, a 1–1 draw.</p>
<p><a href="https://www.wisla.krakow.pl/">Wisła Kraków</a> were formed in 1906 and play their football at the Stadion Miejski im. Henryka Reymana which has a capacity of 33,130.</p>
<p>They have 14 league titles in their trophy cabinet, the most recent win was 2010/2011.</p>
<p><img src="Wisła_Kraków_logo.png" width="200" height="200"> <img src="Wisla stadium.jpg" width="400" height="400"></p>
<p><a href="https://en.wikipedia.org/wiki/MKS_Cracovia">KS Cracovia</a> also formed in 1906, are widely considered to be the oldest club in Kraków. They play their football at the Stadion Cracovii im. Józefa Piłsudskiego which has a capacity of 15,016.</p>
<p>They have 5 league titles in their trophy cabinet, however they are getting a bit dusty. The last time they won the title was 1948.</p>
<p><img src="Cracovia_logo.png" width="200" height="200"> <img src="Cracovia stadium.jfif" width="400" height="400"></p>
<p>So, what happens when these clubs go toe to toe?! Let’s find out by looking at the results for the matches between the bitter rivals over the period of study:</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use multiple CASE WHEN THEN queries to obtain outcomes from all matches between Wisła Kraków and Cracovia</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>derbies <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT date, season, home_team_api_id, away_team_api_id, home_team_goal,away_team_goal,</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                 CASE WHEN home_team_api_ID = 2186 AND home_team_goal &gt; away_team_goal </span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="st">                                 THEN 'KS Cracovia win!'</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                WHEN home_team_api_ID = 2186 AND home_team_goal &lt; away_team_goal </span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                THEN 'Wisła Kraków win!'</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                WHEN home_team_api_id = 10265 AND home_team_goal &gt; away_team_goal</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="st">                                THEN 'Wisła Kraków win!'</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="st">                                 WHEN home_team_api_id = 10265 AND home_team_goal &lt; away_team_goal</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="st">                                THEN 'KS Cracovia win!'</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="st">                                ELSE 'Draw' END AS outcome </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="st">                                FROM Match</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="st">                                WHERE home_team_api_id = 2186 AND away_team_api_id = 10265</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="st">                                OR home_team_api_id = 10265 AND away_team_api_id = 2186'''</span>                                </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                            ,con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a piechart showing the derby outcomes</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>derbies[<span class="st">'outcome'</span>].value_counts().plot(kind<span class="op">=</span><span class="st">'pie'</span>,autopct<span class="op">=</span><span class="st">'</span><span class="sc">%.2f</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>&lt;AxesSubplot: ylabel='outcome'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>derbies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">home_team_api_id</th>
<th data-quarto-table-cell-role="th">away_team_api_id</th>
<th data-quarto-table-cell-role="th">home_team_goal</th>
<th data-quarto-table-cell-role="th">away_team_goal</th>
<th data-quarto-table-cell-role="th">outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2009-03-22 00:00:00</td>
<td>2008/2009</td>
<td>10265</td>
<td>2186</td>
<td>4</td>
<td>1</td>
<td>Wisła Kraków win!</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2008-08-31 00:00:00</td>
<td>2008/2009</td>
<td>2186</td>
<td>10265</td>
<td>1</td>
<td>1</td>
<td>Draw</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2009-11-22 00:00:00</td>
<td>2009/2010</td>
<td>10265</td>
<td>2186</td>
<td>0</td>
<td>1</td>
<td>Cracovia win!</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2010-05-11 00:00:00</td>
<td>2009/2010</td>
<td>2186</td>
<td>10265</td>
<td>1</td>
<td>1</td>
<td>Draw</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2010-11-05 00:00:00</td>
<td>2010/2011</td>
<td>2186</td>
<td>10265</td>
<td>0</td>
<td>1</td>
<td>Wisła Kraków win!</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2011-05-15 00:00:00</td>
<td>2010/2011</td>
<td>10265</td>
<td>2186</td>
<td>1</td>
<td>0</td>
<td>Wisła Kraków win!</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2011-11-06 00:00:00</td>
<td>2011/2012</td>
<td>2186</td>
<td>10265</td>
<td>1</td>
<td>0</td>
<td>Cracovia win!</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2012-04-30 00:00:00</td>
<td>2011/2012</td>
<td>10265</td>
<td>2186</td>
<td>1</td>
<td>0</td>
<td>Wisła Kraków win!</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2014-02-23 00:00:00</td>
<td>2013/2014</td>
<td>10265</td>
<td>2186</td>
<td>3</td>
<td>1</td>
<td>Wisła Kraków win!</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2013-09-21 00:00:00</td>
<td>2013/2014</td>
<td>2186</td>
<td>10265</td>
<td>1</td>
<td>1</td>
<td>Draw</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2014-09-28 00:00:00</td>
<td>2014/2015</td>
<td>2186</td>
<td>10265</td>
<td>1</td>
<td>0</td>
<td>Cracovia win!</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2015-03-21 00:00:00</td>
<td>2014/2015</td>
<td>10265</td>
<td>2186</td>
<td>2</td>
<td>1</td>
<td>Wisła Kraków win!</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2015-11-29 00:00:00</td>
<td>2015/2016</td>
<td>10265</td>
<td>2186</td>
<td>1</td>
<td>2</td>
<td>Cracovia win!</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>2015-07-24 00:00:00</td>
<td>2015/2016</td>
<td>2186</td>
<td>10265</td>
<td>1</td>
<td>1</td>
<td>Draw</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>So, Wisła Kraków have the bragging rights for the period of study. The clubs met 14 times (no derby in 2012/2013 due to KS Cracovia being relegated from the top league in 2011/2012) between 2008/2009 and 2015/2016 :</p>
<ul>
<li>Wisła Kraków wins = 6</li>
<li>KS Cracovia wins = 4</li>
<li>Draws = 4</li>
</ul>
<p>But of course it’s not all about the derby matches. Let’s now take a look at how the two Kraków rivals performed overall.</p>
</section>
<section id="wisła-kraków" class="level2">
<h2 class="anchored" data-anchor-id="wisła-kraków">Wisła Kraków</h2>
<p><img src="Wisla strip.png" width="250" height="250"></p>
<section id="to-20152016" class="level3">
<h3 class="anchored" data-anchor-id="to-20152016">2008/2009 to 2015/2016</h3>
<section id="gooooooooooool" class="level4">
<h4 class="anchored" data-anchor-id="gooooooooooool">Gooooooooooool !</h4>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a SQL CASE WHEN with SUM query to display a table summarizing goals scored and conceded for each season</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiply goals conceded by -1 to allow bi-directional plotting</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>wisla_krakow_goals <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT season, SUM(CASE WHEN home_team_api_id = 10265 THEN home_team_goal END) AS home_goals_scored, </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                       SUM(CASE WHEN away_team_api_id = 10265 THEN away_team_goal END) AS away_goals_scored,</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                       SUM(CASE WHEN home_team_api_id = 10265 THEN away_team_goal END)*-1 AS home_goals_conceded, </span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                       SUM(CASE WHEN away_team_api_id = 10265 THEN home_team_goal END)*-1 AS away_goals_conceded </span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="st">                                       FROM Match </span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="st">                                       GROUP BY season'''</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                                       ,con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bi-directional stacked bar plot showing home and away goals scored and conceded each season</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>wisla_krakow_goals.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">True</span>, title <span class="op">=</span><span class="st">'Wisła Kraków - goals for and against'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>&lt;AxesSubplot: title={'center': 'Wisła Kraków - goals for and against'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-20-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>wisla_krakow_goals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">home_goals_scored</th>
<th data-quarto-table-cell-role="th">away_goals_scored</th>
<th data-quarto-table-cell-role="th">home_goals_conceded</th>
<th data-quarto-table-cell-role="th">away_goals_conceded</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008/2009</td>
<td>31</td>
<td>22</td>
<td>-9</td>
<td>-12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2009/2010</td>
<td>18</td>
<td>30</td>
<td>-9</td>
<td>-11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010/2011</td>
<td>27</td>
<td>17</td>
<td>-11</td>
<td>-18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011/2012</td>
<td>14</td>
<td>15</td>
<td>-11</td>
<td>-15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2012/2013</td>
<td>15</td>
<td>13</td>
<td>-14</td>
<td>-21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2013/2014</td>
<td>23</td>
<td>15</td>
<td>-6</td>
<td>-24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014/2015</td>
<td>20</td>
<td>27</td>
<td>-18</td>
<td>-21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2015/2016</td>
<td>20</td>
<td>25</td>
<td>-17</td>
<td>-18</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We have data for all 8 seasons which confirms that they were not relegated from the top flight during the period of study. Generally speaking, for the period of study Wisła Kraków comfortably score more goals than they concede, the exception being season 2012/13 where they scored just 28 goals (only four more than relegated GKS Bełchatów) they finished 7th that year. We can represent the goal ‘difference’ graphically:</p>
</section>
<section id="goal-difference" class="level4">
<h4 class="anchored" data-anchor-id="goal-difference">Goal difference</h4>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a goal difference column to the wisla_krakow_goals DataFrame</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>wisla_krakow_goals[<span class="st">"goal_diff"</span>] <span class="op">=</span> wisla_krakow_goals[<span class="st">"home_goals_scored"</span>] <span class="op">+</span> wisla_krakow_goals[<span class="st">"away_goals_scored"</span>] <span class="op">+</span> wisla_krakow_goals[<span class="st">"home_goals_conceded"</span>] <span class="op">+</span> wisla_krakow_goals[<span class="st">"away_goals_conceded"</span>] </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the season and goal difference columns and plot</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>wisla_krakow_goal_diff <span class="op">=</span> wisla_krakow_goals[[<span class="st">"season"</span>, <span class="st">"goal_diff"</span>]]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>wisla_krakow_goal_diff.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'Wisła Kraków - goal difference'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>&lt;AxesSubplot: title={'center': 'Wisła Kraków - goal difference'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>wisla_krakow_goal_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">goal_diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008/2009</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2009/2010</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010/2011</td>
<td>15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011/2012</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2012/2013</td>
<td>-7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2013/2014</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014/2015</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2015/2016</td>
<td>10</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>For the period of study Wisła Kraków scored more goals then they conceded, except for the 2012/2013 season.</p>
</section>
<section id="you-win-some-you-lose-some" class="level4">
<h4 class="anchored" data-anchor-id="you-win-some-you-lose-some">You win some, you lose some</h4>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run an SQl query using COUNT CASE WHEN to extract home and away games won and lost</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>wisla_krakow_wins_losses <span class="op">=</span>  pd.read_sql_query(<span class="st">'''SELECT season, </span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN home_team_api_id = 10265 AND home_team_goal &gt; away_team_goal THEN id END) AS home_wins, </span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN away_team_api_id = 10265 AND away_team_goal &gt; home_team_goal THEN id END) AS away_wins, </span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN home_team_api_id = 10265 AND home_team_goal &lt; away_team_goal THEN id END) AS home_defeats, </span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN away_team_api_id = 10265 AND away_team_goal &lt; home_team_goal THEN id END) AS away_defeats </span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                              FROM Match </span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="st">                                              GROUP BY season'''</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                                              ,con)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert defeats to a negative value - multiply by -1 to enable bi-directional plotting</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>wisla_krakow_wins_losses.home_defeats <span class="op">=</span> wisla_krakow_wins_losses.home_defeats <span class="op">*</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>wisla_krakow_wins_losses.away_defeats <span class="op">=</span> wisla_krakow_wins_losses.away_defeats <span class="op">*</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a stacked bar plot showing home and away wins and defeats for each season</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>wisla_krakow_wins_losses.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">True</span>, title <span class="op">=</span><span class="st">'Wisła Kraków - games won and lost'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>&lt;AxesSubplot: title={'center': 'Wisła Kraków - games won and lost'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-24-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>wisla_krakow_wins_losses</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">home_wins</th>
<th data-quarto-table-cell-role="th">away_wins</th>
<th data-quarto-table-cell-role="th">home_defeats</th>
<th data-quarto-table-cell-role="th">away_defeats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008/2009</td>
<td>13</td>
<td>6</td>
<td>-1</td>
<td>-3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2009/2010</td>
<td>8</td>
<td>11</td>
<td>-4</td>
<td>-2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010/2011</td>
<td>11</td>
<td>6</td>
<td>-2</td>
<td>-6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011/2012</td>
<td>7</td>
<td>5</td>
<td>-6</td>
<td>-5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2012/2013</td>
<td>6</td>
<td>4</td>
<td>-6</td>
<td>-6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2013/2014</td>
<td>10</td>
<td>2</td>
<td>-3</td>
<td>-6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014/2015</td>
<td>6</td>
<td>5</td>
<td>-4</td>
<td>-5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2015/2016</td>
<td>3</td>
<td>5</td>
<td>-4</td>
<td>-5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>From the above stacked bar chart we can see a downward trend. Wisła Kraków only won 8 matches in 2015/2016, finishing the season in 11th place.</p>
</section>
<section id="home-advantage" class="level4">
<h4 class="anchored" data-anchor-id="home-advantage">Home advantage?</h4>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run an SQl query using COUNT CASE WHEN to extract % of home and away games won</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>wisla_krakow_win_pct <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT season, </span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                         ROUND(AVG(CASE WHEN home_team_api_id = 10265 AND home_team_goal &gt; away_team_goal THEN 1 </span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="st">                                                   WHEN home_team_api_id = 10265 AND home_team_goal &lt; away_team_goal THEN 0 END)*100,2) AS pct_home_wins, </span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                         ROUND(AVG(CASE WHEN away_team_api_id = 10265 AND away_team_goal &gt; home_team_goal THEN 1 </span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                                   WHEN away_team_api_id = 10265 AND away_team_goal &lt; home_team_goal THEN 0 END)*100,2) AS pct_away_wins </span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                         FROM Match </span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="st">                                         GROUP BY season'''</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                                         ,con)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bar plot showing % of home and away wins for each season</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>wisla_krakow_win_pct.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'Wisła Kraków - win percentages'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>&lt;AxesSubplot: title={'center': 'Wisła Kraków - win percentages'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>wisla_krakow_win_pct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">pct_home_wins</th>
<th data-quarto-table-cell-role="th">pct_away_wins</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008/2009</td>
<td>92.86</td>
<td>66.67</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2009/2010</td>
<td>66.67</td>
<td>84.62</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010/2011</td>
<td>84.62</td>
<td>50.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011/2012</td>
<td>53.85</td>
<td>50.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2012/2013</td>
<td>50.00</td>
<td>40.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2013/2014</td>
<td>76.92</td>
<td>25.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014/2015</td>
<td>60.00</td>
<td>50.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2015/2016</td>
<td>42.86</td>
<td>50.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In the early part of the period of study, Wisła Kraków had a reputation of being a tough nut to crack at home. They won the league in 2008/2009, winning just under 93% of their home matches! They also had a high degreee of success on the road, winning two thirds of their away matches. They won the league again 2010/2011 with a lower percentage of wins.</p>
</section>
<section id="points-make-prizes" class="level4">
<h4 class="anchored" data-anchor-id="points-make-prizes">Points make prizes</h4>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run an SQl query using COUNT CASE WHEN to extract home and away games won,lost, and drawn</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>wisla_krakow_points <span class="op">=</span>  pd.read_sql_query(<span class="st">'''SELECT season, </span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN home_team_api_id = 10265 AND home_team_goal &gt; away_team_goal THEN id END) AS home_wins, </span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN away_team_api_id = 10265 AND away_team_goal &gt; home_team_goal THEN id END) AS away_wins, </span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN home_team_api_id = 10265 AND home_team_goal = away_team_goal THEN id END) AS home_draws, </span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN away_team_api_id = 10265 AND away_team_goal = home_team_goal THEN id END) AS away_draws, </span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN home_team_api_id = 10265 AND home_team_goal &lt; away_team_goal THEN id END) AS home_defeats, </span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN away_team_api_id = 10265 AND away_team_goal &lt; home_team_goal THEN id END) AS away_defeats </span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="st">                                              FROM Match </span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="st">                                              GROUP BY season'''</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>                                              ,con)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate points - 3 for a win, 1 for a draw, 0 for a loss</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>wisla_krakow_points[<span class="st">"points"</span>] <span class="op">=</span> wisla_krakow_points[<span class="st">'home_wins'</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span>  wisla_krakow_points[<span class="st">'away_wins'</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> wisla_krakow_points[<span class="st">'home_draws'</span>] <span class="op">+</span> wisla_krakow_points[<span class="st">'away_draws'</span>]</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>wisla_krakow_points <span class="op">=</span> wisla_krakow_points[[<span class="st">"season"</span>,<span class="st">"points"</span>]]</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bar plot showing total points for each season</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>wisla_krakow_points.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'Wisła Kraków - total points'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>&lt;AxesSubplot: title={'center': 'Wisła Kraków - total points'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-28-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>wisla_krakow_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">points</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008/2009</td>
<td>64</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2009/2010</td>
<td>62</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010/2011</td>
<td>56</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011/2012</td>
<td>43</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2012/2013</td>
<td>38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2013/2014</td>
<td>45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014/2015</td>
<td>43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2015/2016</td>
<td>37</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Wisła Kraków won the league in 2008/2009 with 64 points but 62 points the following year was only good enough for second place (behind a Robert Lewandowski inspired Lech Poznań). Only 56 points were needed to win the league in 2010/2011.</p>
</section>
<section id="final-standings" class="level4">
<h4 class="anchored" data-anchor-id="final-standings">Final standings</h4>
<p>Let’s add an extra column for league position data:</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an extra column and insert into our original points DataFrame</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>wisla_krakow_points.insert(<span class="dv">0</span>,<span class="st">"Position"</span>,[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">11</span>],<span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a horizontal bar plot of league position</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>wisla_krakow_points.plot.barh(x<span class="op">=</span><span class="st">'season'</span>, y<span class="op">=</span><span class="st">'Position'</span>, title <span class="op">=</span><span class="st">'Wisła Kraków - final league position'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>&lt;AxesSubplot: title={'center': 'Wisła Kraków - final league position'}, ylabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-31-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>wisla_krakow_position <span class="op">=</span> wisla_krakow_points[[<span class="st">"season"</span>,<span class="st">"points"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">points</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>2008/2009</td>
<td>64</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>2009/2010</td>
<td>62</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>2010/2011</td>
<td>56</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7</td>
<td>2011/2012</td>
<td>43</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>7</td>
<td>2012/2013</td>
<td>38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>5</td>
<td>2013/2014</td>
<td>45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>5</td>
<td>2014/2015</td>
<td>43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>11</td>
<td>2015/2016</td>
<td>37</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The general trend for Wisła Kraków is one of decline. They have struggled since the heights of 2008/2009 to 2010/2011 where they were placed 1, 2, 1, finishing 11th in 2015/2016.</p>
</section>
</section>
<section id="to-20212022" class="level3">
<h3 class="anchored" data-anchor-id="to-20212022">2016/2017 to 2021/2022</h3>
<p>The European Soccer Database is now somewhat out of date, so I decided to gather data for seasons 2016/2017 to 2021/2022 and create dictionaries for conversion to DataFrames.</p>
<section id="gooooooooooool-1" class="level4">
<h4 class="anchored" data-anchor-id="gooooooooooool-1">Gooooooooooool !</h4>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary for the most recent years</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>wisla_recent <span class="op">=</span> {<span class="st">'season'</span>: [<span class="st">'2016/2017'</span>, <span class="st">'2017/2018'</span>, <span class="st">'2018/2019'</span>, <span class="st">'2019/2020'</span>, <span class="st">'2020/2021'</span>,<span class="st">'2021/2022'</span>],</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'goals_scored'</span>: [<span class="dv">45</span>, <span class="dv">41</span>, <span class="dv">55</span>, <span class="dv">37</span>, <span class="dv">39</span>, <span class="dv">37</span>],</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'goals_conceded'</span>: [<span class="dv">46</span>, <span class="dv">36</span>, <span class="dv">48</span>, <span class="dv">47</span>,<span class="dv">42</span>, <span class="dv">54</span>],</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'games_won'</span>: [<span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">7</span>],</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'games_lost'</span>: [<span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">17</span>],</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'games_drawn'</span>: [<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">10</span>],</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">'points'</span>:[<span class="dv">44</span>, <span class="dv">44</span>, <span class="dv">42</span>, <span class="dv">35</span>, <span class="dv">33</span>, <span class="dv">31</span>],</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">'position'</span>:[<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">17</span>]</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>        } </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert dictionary to a DataFrame</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>wisla_recent <span class="op">=</span> pd.DataFrame.from_dict(wisla_recent)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for columns to be plotted</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>wisla_recent_goals <span class="op">=</span> wisla_recent[[<span class="st">'season'</span>,<span class="st">'goals_scored'</span>,<span class="st">'goals_conceded'</span>,]]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bar plot showing goals scored and conceded each season</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>wisla_recent_goals.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'Wisła Kraków - goals for and against'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>&lt;AxesSubplot: title={'center': 'Wisła Kraków - goals for and against'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>wisla_recent_goals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">goals_scored</th>
<th data-quarto-table-cell-role="th">goals_conceded</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2016/2017</td>
<td>45</td>
<td>46</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2017/2018</td>
<td>41</td>
<td>36</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2018/2019</td>
<td>55</td>
<td>48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2019/2020</td>
<td>37</td>
<td>47</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2020/2021</td>
<td>39</td>
<td>42</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2021/2022</td>
<td>37</td>
<td>54</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Wisła Kraków leaked 54 goals in the 2021/2022 season which was enough to see them relegated to the 2nd tier of Polish football.</p>
</section>
<section id="win-lose-or-draw" class="level4">
<h4 class="anchored" data-anchor-id="win-lose-or-draw">Win, lose or draw</h4>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for columns to be plotted</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>wisla_recent_wins <span class="op">=</span> wisla_recent[[<span class="st">'season'</span>,<span class="st">'games_won'</span>,<span class="st">'games_drawn'</span>,<span class="st">'games_lost'</span>]]</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bar plot showing goals won, lost, and drawn each season</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>wisla_recent_wins.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'Wisła Kraków - win, draw, lose'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>&lt;AxesSubplot: title={'center': 'Wisła Kraków - win, draw, lose'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-36-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>wisla_recent_wins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">games_won</th>
<th data-quarto-table-cell-role="th">games_drawn</th>
<th data-quarto-table-cell-role="th">games_lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2016/2017</td>
<td>13</td>
<td>5</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2017/2018</td>
<td>12</td>
<td>8</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2018/2019</td>
<td>12</td>
<td>6</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2019/2020</td>
<td>10</td>
<td>5</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2020/2021</td>
<td>8</td>
<td>9</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2021/2022</td>
<td>7</td>
<td>10</td>
<td>17</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Wisła Kraków lost 17 out of 34 games in the 2021/2022 season which contributed to their relegation to the 2nd tier of Polish football.</p>
</section>
<section id="points-make-prizes-1" class="level4">
<h4 class="anchored" data-anchor-id="points-make-prizes-1">Points make prizes</h4>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for columns to be plotted</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>wisla_recent_points <span class="op">=</span> wisla_recent[[<span class="st">'season'</span>,<span class="st">'points'</span>]]</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bar plot showing total points for each season</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>wisla_recent_points.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'Wisła Kraków - total points'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>&lt;AxesSubplot: title={'center': 'Wisła Kraków - total points'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-38-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>wisla_recent_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">points</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2016/2017</td>
<td>44</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2017/2018</td>
<td>44</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2018/2019</td>
<td>42</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2019/2020</td>
<td>35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2020/2021</td>
<td>33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2021/2022</td>
<td>31</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As we can see. there was a steady decline in point totals from 2018/2019 onwards. Wisła Kraków accumulated just 31 points from their 34 matches in the 2021/2022 season which was not enough to retain their top flight status.</p>
</section>
<section id="final-standings-1" class="level4">
<h4 class="anchored" data-anchor-id="final-standings-1">Final standings</h4>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a horizontal bar plot of league position</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>wisla_recent.plot.barh(x<span class="op">=</span><span class="st">'season'</span>, y<span class="op">=</span><span class="st">'position'</span>, title <span class="op">=</span><span class="st">'Wisła Kraków - final league position'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>&lt;AxesSubplot: title={'center': 'Wisła Kraków - final league position'}, ylabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-40-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>wisla_position <span class="op">=</span> wisla_recent[[<span class="st">"season"</span>,<span class="st">"position"</span>]]</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>wisla_position </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">position</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2016/2017</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2017/2018</td>
<td>7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2018/2019</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2019/2020</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2020/2021</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2021/2022</td>
<td>17</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The decline in points totals is mirrored by a declining league position. Wisła Kraków accumulated just 31 points from their 34 matches in the 2021/2022 season and were relegated.</p>
</section>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section">2022/2023</h3>
<p>The second tier I Liga table for 2022/2023 at the time of writing is shown below. The season is on hold as the FIFA World Cup - Qatar 2022 progresses. Wisła Kraków are languishing mid table. A long way away from the dizzy heights of the Ekstraklasa championship winning side of 2010/2011.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Krakow_Football_files/figure-html/4d9c9c07-47ca-49bb-8e43-f1ccffb810fb-1-e5a7e284-1a62-4ccc-b3c2-00b7469d4ee1.PNG" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Liga_1_2022_2-23.PNG</figcaption>
</figure>
</div>
</section>
</section>
<section id="ks-cracovia" class="level2">
<h2 class="anchored" data-anchor-id="ks-cracovia">KS Cracovia</h2>
<p><img src="cracovia strip.jpg" width="200" height="200"></p>
<section id="to-20152016-1" class="level3">
<h3 class="anchored" data-anchor-id="to-20152016-1">2008/2009 to 2015/2016</h3>
<section id="gooooooooooool-2" class="level4">
<h4 class="anchored" data-anchor-id="gooooooooooool-2">Gooooooooooool !</h4>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now that we already have the query structure in place, we can simply replace the home_team_api_id with that for Cracovia - 2186</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>cracovia_goals <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT season, </span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                   ROUND(SUM(CASE WHEN home_team_api_id = 2186 THEN home_team_goal END),2) AS home_goals_scored, </span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="st">                                   ROUND(SUM(CASE WHEN away_team_api_id = 2186 THEN away_team_goal END),2) AS away_goals_scored, </span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                   SUM(CASE WHEN home_team_api_id = 2186 THEN away_team_goal END)*-1 AS home_goals_conceded, </span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                   SUM(CASE WHEN away_team_api_id = 2186 THEN home_team_goal END)*-1 AS away_goals_conceded </span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                   FROM Match </span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="st">                                   GROUP BY season'''</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                                   ,con)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a stacked bar plot showing home and away goals scored and conceded each season</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>cracovia_goals.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">True</span>, title <span class="op">=</span><span class="st">'KS Cracovia - goals for and against'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>&lt;AxesSubplot: title={'center': 'KS Cracovia - goals for and against'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-42-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>cracovia_goals </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">home_goals_scored</th>
<th data-quarto-table-cell-role="th">away_goals_scored</th>
<th data-quarto-table-cell-role="th">home_goals_conceded</th>
<th data-quarto-table-cell-role="th">away_goals_conceded</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008/2009</td>
<td>12.0</td>
<td>12.0</td>
<td>-8.0</td>
<td>-32.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2009/2010</td>
<td>18.0</td>
<td>7.0</td>
<td>-23.0</td>
<td>-16.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010/2011</td>
<td>30.0</td>
<td>7.0</td>
<td>-21.0</td>
<td>-26.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011/2012</td>
<td>10.0</td>
<td>10.0</td>
<td>-20.0</td>
<td>-21.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2012/2013</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2013/2014</td>
<td>19.0</td>
<td>18.0</td>
<td>-22.0</td>
<td>-21.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014/2015</td>
<td>21.0</td>
<td>14.0</td>
<td>-17.0</td>
<td>-24.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2015/2016</td>
<td>34.0</td>
<td>23.0</td>
<td>-19.0</td>
<td>-23.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Interestingly, we have a <strong><em>Not a Number (NaN)</em></strong> reference for season 2012/2013. On follow up it transpires that KS Cracovia finished bottom of the Ekstraklasa in 2011/2012 (as we can see above they only scored 20 goals in total that season) and were relegated to the <strong><em>I liga</em></strong>, the second tier of Polish football. They made an immediate return and the 37 goals scored in 2013/2014 was enough to secure them a repectable 9th spot out of 16. They scored 57 goals in 2015/2016 (finishing 5th), a goal tally only bettered by champions Legia Warszawa.</p>
</section>
<section id="goal-difference-1" class="level4">
<h4 class="anchored" data-anchor-id="goal-difference-1">Goal difference</h4>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a goal difference column to the cracovia_goals DataFrame</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>cracovia_goals[<span class="st">"goal_diff"</span>] <span class="op">=</span> cracovia_goals[<span class="st">"home_goals_scored"</span>] <span class="op">+</span> cracovia_goals[<span class="st">"away_goals_scored"</span>] <span class="op">+</span> cracovia_goals[<span class="st">"home_goals_conceded"</span>] <span class="op">+</span> cracovia_goals[<span class="st">"away_goals_conceded"</span>] </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the season and goal difference columns and plot</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>cracovia_goal_diff <span class="op">=</span> cracovia_goals[[<span class="st">"season"</span>, <span class="st">"goal_diff"</span>]]</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>cracovia_goal_diff.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'KS Cracovia - goal difference'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>&lt;AxesSubplot: title={'center': 'KS Cracovia - goal difference'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-44-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>cracovia_goal_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">goal_diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008/2009</td>
<td>-16.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2009/2010</td>
<td>-14.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010/2011</td>
<td>-10.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011/2012</td>
<td>-21.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2012/2013</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2013/2014</td>
<td>-6.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014/2015</td>
<td>-6.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2015/2016</td>
<td>15.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As noted before, we have no data for 2012/2013 as KS Cracovia were relegated in 2011/2012. A goal difference of -21 highlights the poor performance that year. For all the years of study (with the exception of 2015/2016 where they finished 5th) KS Cracovia conceded more goals than they scored.</p>
</section>
<section id="you-win-some-you-lose-some-1" class="level4">
<h4 class="anchored" data-anchor-id="you-win-some-you-lose-some-1">You win some, you lose some</h4>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run an SQl query using COUNT CASE WHEN to extract home and away games won and lost</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>cracovia_wins_losses <span class="op">=</span>  pd.read_sql_query(<span class="st">'''SELECT season, </span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                          COUNT(CASE WHEN home_team_api_id = 2186 AND home_team_goal &gt; away_team_goal THEN id END) AS home_wins, </span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="st">                                          COUNT(CASE WHEN away_team_api_id = 2186 AND away_team_goal &gt; home_team_goal THEN id END) AS away_wins, </span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                          COUNT(CASE WHEN home_team_api_id = 2186 AND home_team_goal &lt; away_team_goal THEN id END) AS home_defeats, </span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                          COUNT(CASE WHEN away_team_api_id = 2186 AND away_team_goal &lt; home_team_goal THEN id END) AS away_defeats </span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                          FROM Match </span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="st">                                          GROUP BY season'''</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>                                          ,con)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert defeats to a negative value - multiply by -1 to allow bi-directional plotting</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>cracovia_wins_losses.home_defeats <span class="op">=</span> cracovia_wins_losses.home_defeats <span class="op">*</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>cracovia_wins_losses.away_defeats <span class="op">=</span> cracovia_wins_losses.away_defeats <span class="op">*</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a stacked bar plot showing home and away wins and defeats each season</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>cracovia_wins_losses.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">True</span>, title <span class="op">=</span><span class="st">'KS Cracovia - games won and lost'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>&lt;AxesSubplot: title={'center': 'KS Cracovia - games won and lost'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-46-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>cracovia_wins_losses</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">home_wins</th>
<th data-quarto-table-cell-role="th">away_wins</th>
<th data-quarto-table-cell-role="th">home_defeats</th>
<th data-quarto-table-cell-role="th">away_defeats</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008/2009</td>
<td>6</td>
<td>1</td>
<td>-3</td>
<td>-11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2009/2010</td>
<td>5</td>
<td>4</td>
<td>-7</td>
<td>-7</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010/2011</td>
<td>7</td>
<td>1</td>
<td>-6</td>
<td>-11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011/2012</td>
<td>3</td>
<td>1</td>
<td>-8</td>
<td>-8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2012/2013</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2013/2014</td>
<td>6</td>
<td>5</td>
<td>-7</td>
<td>-6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014/2015</td>
<td>8</td>
<td>2</td>
<td>-4</td>
<td>-9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2015/2016</td>
<td>7</td>
<td>5</td>
<td>-4</td>
<td>-5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>From the above stacked bar chart we can see a downward trend from 2009/2010 culminating in KS Cracovia being relegated in 2011/2012, with only 4 wins all season. After their return in 2013/2014 they seem to have consolidated. During the period of study KS Cracovia generally lost more games than they won, with the exception of 2015/2016 where they finished the season in a very respectable 5th place.</p>
</section>
<section id="home-advantage-1" class="level4">
<h4 class="anchored" data-anchor-id="home-advantage-1">Home advantage?</h4>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run an SQl query using AVG CASE WHEN to extract % of home and away games won</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>cracovia_win_pct <span class="op">=</span> pd.read_sql_query(<span class="st">'''SELECT season, </span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                     ROUND(AVG(CASE WHEN home_team_api_id = 2186 AND home_team_goal &gt; away_team_goal THEN 1 </span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="st">                                               WHEN home_team_api_id = 2186 AND home_team_goal &lt; away_team_goal THEN 0 END)*100,2) AS pct_home_wins, </span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                     ROUND(AVG(CASE WHEN away_team_api_id = 2186 AND away_team_goal &gt; home_team_goal THEN 1 </span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                               WHEN away_team_api_id = 2186 AND away_team_goal &lt; home_team_goal THEN 0 END)*100,2) AS pct_away_wins </span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                     FROM Match </span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="st">                                     GROUP BY season'''</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>                                     ,con)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bar plot showing % of home and away wins for each season</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>cracovia_win_pct.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'KS Cracovia - win percentages'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>&lt;AxesSubplot: title={'center': 'KS Cracovia - win percentages'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-48-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>cracovia_win_pct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">pct_home_wins</th>
<th data-quarto-table-cell-role="th">pct_away_wins</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008/2009</td>
<td>66.67</td>
<td>8.33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2009/2010</td>
<td>41.67</td>
<td>36.36</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010/2011</td>
<td>53.85</td>
<td>8.33</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011/2012</td>
<td>27.27</td>
<td>11.11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2012/2013</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2013/2014</td>
<td>46.15</td>
<td>45.45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014/2015</td>
<td>66.67</td>
<td>18.18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2015/2016</td>
<td>63.64</td>
<td>50.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In the case of KS Cracovia, home advantage certainly seems to be a factor. For an in-depth study of home advantage in European Football Leagues see <a href="https://www.mdpi.com/2227-9091/8/3/87">this article</a>.</p>
</section>
<section id="points-make-prizes-2" class="level4">
<h4 class="anchored" data-anchor-id="points-make-prizes-2">Points make prizes</h4>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run an SQl query using COUNT CASE WHEN to extract home and away games won,lost, and drawn</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>cracovia_points <span class="op">=</span>  pd.read_sql_query(<span class="st">'''SELECT season, </span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN home_team_api_id = 2186 AND home_team_goal &gt; away_team_goal THEN id END) AS home_wins, </span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN away_team_api_id = 2186 AND away_team_goal &gt; home_team_goal THEN id END) AS away_wins, </span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN home_team_api_id = 2186 AND home_team_goal = away_team_goal THEN id END) AS home_draws, </span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN away_team_api_id = 2186 AND away_team_goal = home_team_goal THEN id END) AS away_draws, </span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN home_team_api_id = 2186 AND home_team_goal &lt; away_team_goal THEN id END) AS home_defeats, </span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="st">                                              COUNT(CASE WHEN away_team_api_id = 2186 AND away_team_goal &lt; home_team_goal THEN id END) AS away_defeats </span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="st">                                              FROM Match </span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="st">                                              GROUP BY season'''</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>                                              ,con)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate points total for each season - 3 for a win, 1 for a draw, 0 for a loss</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>cracovia_points[<span class="st">"points"</span>] <span class="op">=</span> cracovia_points[<span class="st">'home_wins'</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span>  cracovia_points[<span class="st">'away_wins'</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> cracovia_points[<span class="st">'home_draws'</span>] <span class="op">+</span> cracovia_points[<span class="st">'away_draws'</span>]</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for the seasom and points columns for plotting</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>cracovia_points <span class="op">=</span> cracovia_points[[<span class="st">"season"</span>,<span class="st">"points"</span>]]</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bar plot showing total points for each season</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>cracovia_points.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'KS Cracovia - total points'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>&lt;AxesSubplot: title={'center': 'KS Cracovia - total points'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-50-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>cracovia_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">points</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2008/2009</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2009/2010</td>
<td>34</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2010/2011</td>
<td>29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011/2012</td>
<td>22</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2012/2013</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2013/2014</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2014/2015</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2015/2016</td>
<td>45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Cracovia were relegated in 2011/2012 with 22 points.</p>
</section>
<section id="final-standings-2" class="level4">
<h4 class="anchored" data-anchor-id="final-standings-2">Final standings</h4>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an extra column and insert into our original points DataFrame</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>cracovia_points.insert(<span class="dv">0</span>,<span class="st">"Position"</span>,[<span class="dv">14</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">5</span>],<span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a horizontal bar plot of league position</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>cracovia_points.plot.barh(x<span class="op">=</span><span class="st">'season'</span>, y<span class="op">=</span><span class="st">'Position'</span>, title <span class="op">=</span><span class="st">'KS Cracovia - final league position'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>&lt;AxesSubplot: title={'center': 'KS Cracovia - final league position'}, ylabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-53-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>cracovia_position <span class="op">=</span> cracovia_points</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>cracovia_position </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">points</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>14</td>
<td>2008/2009</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>12</td>
<td>2009/2010</td>
<td>34</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>14</td>
<td>2010/2011</td>
<td>29</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>16</td>
<td>2011/2012</td>
<td>22</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0</td>
<td>2012/2013</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>9</td>
<td>2013/2014</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>12</td>
<td>2014/2015</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>5</td>
<td>2015/2016</td>
<td>45</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>As we can see the trend for KS Cracovia is better since they returned to the Ekstraklasa in 2013/2014. They finished a respectable 9th on their first season back in the top league, and finished in 5th place in 2015/2016.</p>
</section>
</section>
<section id="to-20212022-1" class="level3">
<h3 class="anchored" data-anchor-id="to-20212022-1">2016/2017 to 2021/2022</h3>
<p>The European Soccer Database is now somewhat out of date, so I decided to gather data for seasons 2016/2017 to 2021/2022 and create dictionaries for conversion to DataFrames.</p>
<section id="gooooooooooool-3" class="level4">
<h4 class="anchored" data-anchor-id="gooooooooooool-3">Gooooooooooool !</h4>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary for the most recent years</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>cracovia_recent <span class="op">=</span> {<span class="st">'season'</span>: [<span class="st">'2016/2017'</span>, <span class="st">'2017/2018'</span>, <span class="st">'2018/2019'</span>, <span class="st">'2019/2020'</span>, <span class="st">'2020/2021'</span>,<span class="st">'2021/2022'</span>],</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'goals_scored'</span>: [<span class="dv">38</span>, <span class="dv">40</span>, <span class="dv">39</span>, <span class="dv">39</span>,<span class="dv">28</span>,<span class="dv">40</span>],</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'goals_conceded'</span>: [<span class="dv">43</span>, <span class="dv">40</span>, <span class="dv">34</span>, <span class="dv">29</span>,<span class="dv">32</span>,<span class="dv">42</span>],</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'games_won'</span>: [<span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">14</span>,<span class="dv">8</span>,<span class="dv">12</span>],</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'games_lost'</span>: [<span class="dv">11</span>, <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">12</span>],</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'games_drawn'</span>: [<span class="dv">13</span>,<span class="dv">9</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">13</span>,<span class="dv">10</span>],</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'points'</span>:[<span class="dv">31</span>,<span class="dv">39</span>,<span class="dv">48</span>,<span class="dv">46</span>,<span class="dv">32</span>,<span class="dv">46</span>],</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'position'</span>:[<span class="dv">13</span>,<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">14</span>,<span class="dv">9</span>]</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>        } </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert dictionary to a DataFrame</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>cracovia_recent <span class="op">=</span> pd.DataFrame.from_dict(cracovia_recent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for columns to be plotted</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>cracovia_recent_goals <span class="op">=</span> cracovia_recent[[<span class="st">'season'</span>,<span class="st">'goals_scored'</span>,<span class="st">'goals_conceded'</span>,]]</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bar plot showing goals scored and conceded each season</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>cracovia_recent_goals.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'KS Cracovia - goals for and against'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>&lt;AxesSubplot: title={'center': 'KS Cracovia - goals for and against'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-56-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>cracovia_recent_goals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">goals_scored</th>
<th data-quarto-table-cell-role="th">goals_conceded</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2016/2017</td>
<td>38</td>
<td>43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2017/2018</td>
<td>40</td>
<td>40</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2018/2019</td>
<td>39</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2019/2020</td>
<td>39</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2020/2021</td>
<td>28</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2021/2022</td>
<td>40</td>
<td>42</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In the last couple of years KS Cracova have conceded more than they have scored, although they seem to have added extra fire power up front in 2021/2022 with 40 goals scored compared to only 28 in 2020/2021.</p>
</section>
<section id="win-lose-or-draw-1" class="level4">
<h4 class="anchored" data-anchor-id="win-lose-or-draw-1">Win, lose or draw</h4>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for columns to be plotted</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>cracovia_recent_wins <span class="op">=</span> cracovia_recent[[<span class="st">'season'</span>,<span class="st">'games_won'</span>,<span class="st">'games_drawn'</span>,<span class="st">'games_lost'</span>]]</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bar plot showing goals won, lost, and drawn each season</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>cracovia_recent_wins.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'KS Cracovia - win, draw, lose'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>&lt;AxesSubplot: title={'center': 'KS Cracovia - win, draw, lose'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-58-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>cracovia_recent_wins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">games_won</th>
<th data-quarto-table-cell-role="th">games_drawn</th>
<th data-quarto-table-cell-role="th">games_lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2016/2017</td>
<td>6</td>
<td>13</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2017/2018</td>
<td>10</td>
<td>9</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2018/2019</td>
<td>14</td>
<td>6</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2019/2020</td>
<td>14</td>
<td>4</td>
<td>12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2020/2021</td>
<td>8</td>
<td>13</td>
<td>9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2021/2022</td>
<td>12</td>
<td>10</td>
<td>12</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>KS Cracovia performed very well in 2018/2019 and 2019/2020. Season 2021/2022 was a year of consolidation, with an almost even split of wins, draws, and losses.</p>
</section>
<section id="points-make-prizes-3" class="level4">
<h4 class="anchored" data-anchor-id="points-make-prizes-3">Points make prizes</h4>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for columns to be plotted</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>cracovia_recent_points <span class="op">=</span> cracovia_recent[[<span class="st">'season'</span>,<span class="st">'points'</span>]]</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a bar plot showing total points for each season</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>cracovia_recent_points.plot.bar(x<span class="op">=</span><span class="st">'season'</span>, stacked<span class="op">=</span><span class="va">False</span>, title <span class="op">=</span><span class="st">'KS Cracovia - total points'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>&lt;AxesSubplot: title={'center': 'KS Cracovia - total points'}, xlabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-60-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>cracovia_recent_points</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">points</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2016/2017</td>
<td>31</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2017/2018</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2018/2019</td>
<td>48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2019/2020</td>
<td>46</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2020/2021</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2021/2022</td>
<td>46</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The points total of 32 for season 2020/2021 is net of a 5 point deduction imposed for corrupt activity backdated from the 2003/2004 season</li>
<li>The number of league games played increased to 34 for season 2021/2022 due to league reconstruction</li>
</ul>
</div>
</div>
</section>
<section id="final-standings-3" class="level4">
<h4 class="anchored" data-anchor-id="final-standings-3">Final standings</h4>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a horizontal bar plot of league position</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>cracovia_recent.plot.barh(x<span class="op">=</span><span class="st">'season'</span>, y<span class="op">=</span><span class="st">'position'</span>, title <span class="op">=</span><span class="st">'KS Cracovia - final league position'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>&lt;AxesSubplot: title={'center': 'KS Cracovia - final league position'}, ylabel='season'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Krakow_Football_files/figure-html/cell-62-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>cracovia_position <span class="op">=</span> cracovia_recent[[<span class="st">"season"</span>,<span class="st">"position"</span>]]</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>cracovia_position </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">season</th>
<th data-quarto-table-cell-role="th">position</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2016/2017</td>
<td>13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2017/2018</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2018/2019</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2019/2020</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2020/2021</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2021/2022</td>
<td>9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Mixed fortunes for KS Cracovia, an improvement from 2016/2017 and a 4th place finish in 2018/2019. Snce then things have tailed off somewhat.</p>
</section>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1">2022/2023</h3>
<p>The Ekstraklasa league table for 2022/2023 at the time of writing is shown below. The season is on hold as the FIFA World Cup - Qatar 2022 progresses. KS Cracovia are sitting in 8th place, just four points behind Widzew and Pogon Szczecin in 3rd and 4th place respectively. Raków Częstochowa have a 9 point lead at the top of the table over nearest challengers Legia Warsaw.</p>
<p><img src="Krakow_Football_files/figure-html/d652baad-4364-4545-b8d9-f09a7808dcff-1-f84441a8-29d8-4bde-be0f-792c8463c58b.PNG" class="img-fluid" alt="ekstraklasa.PNG">!</p>
</section>
</section>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key takeaways</h2>
<p>When I first had the idea for this project I did not know if it was even possible to run SQL queries using Python within JupyterLab. This was a very satisfying project as it opens up the possibility of further project ideas using data stored within a database. The combined power of SQL and Python is formidable, and allows data which is stored in different locations and different formats to be pulled together, cleaned, manipulated, filtered and presented graphically in a way that produces meaningful insights, and facilitates data-driven decision making.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>