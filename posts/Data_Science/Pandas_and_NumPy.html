<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Into the Unknown - Introduction to Pandas and NumPy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Into the Unknown</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">Stephen Barrie</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Stephen137" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/sjbarrie" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Introduction to Pandas and NumPy</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pandas" id="toc-pandas" class="nav-link active" data-scroll-target="#pandas">Pandas</a></li>
  <li><a href="#numpy" id="toc-numpy" class="nav-link" data-scroll-target="#numpy">NumPy</a></li>
  <li><a href="#numpy-arrays" id="toc-numpy-arrays" class="nav-link" data-scroll-target="#numpy-arrays">NumPy Arrays</a></li>
  <li><a href="#pandas-series-and-dataframes" id="toc-pandas-series-and-dataframes" class="nav-link" data-scroll-target="#pandas-series-and-dataframes">Pandas Series and Dataframes</a></li>
  <li><a href="#dataframe" id="toc-dataframe" class="nav-link" data-scroll-target="#dataframe">DataFrame</a></li>
  <li><a href="#create-a-dataframe" id="toc-create-a-dataframe" class="nav-link" data-scroll-target="#create-a-dataframe">Create a DataFrame</a></li>
  <li><a href="#create-a-dataframe-from-a-dictionary" id="toc-create-a-dataframe-from-a-dictionary" class="nav-link" data-scroll-target="#create-a-dataframe-from-a-dictionary">Create a DataFrame from a dictionary</a></li>
  <li><a href="#create-a-dataframe-from-a-list-of-lists" id="toc-create-a-dataframe-from-a-list-of-lists" class="nav-link" data-scroll-target="#create-a-dataframe-from-a-list-of-lists">Create a DataFrame from a list of lists [[ ]]</a></li>
  <li><a href="#comma-separated-variables-csv" id="toc-comma-separated-variables-csv" class="nav-link" data-scroll-target="#comma-separated-variables-csv">Comma Separated Variables (CSV)</a></li>
  <li><a href="#loading-and-saving-csvs" id="toc-loading-and-saving-csvs" class="nav-link" data-scroll-target="#loading-and-saving-csvs">Loading and Saving CSVs</a></li>
  <li><a href="#inspect-a-dataframe" id="toc-inspect-a-dataframe" class="nav-link" data-scroll-target="#inspect-a-dataframe">Inspect a DataFrame</a></li>
  <li><a href="#select-columns" id="toc-select-columns" class="nav-link" data-scroll-target="#select-columns">Select Columns</a></li>
  <li><a href="#selecting-multiple-columns" id="toc-selecting-multiple-columns" class="nav-link" data-scroll-target="#selecting-multiple-columns">Selecting Multiple Columns</a></li>
  <li><a href="#select-rows" id="toc-select-rows" class="nav-link" data-scroll-target="#select-rows">Select Rows</a></li>
  <li><a href="#selecting-multiple-rows" id="toc-selecting-multiple-rows" class="nav-link" data-scroll-target="#selecting-multiple-rows">Selecting Multiple Rows</a></li>
  <li><a href="#select-rows-with-logic-i" id="toc-select-rows-with-logic-i" class="nav-link" data-scroll-target="#select-rows-with-logic-i">Select Rows with Logic I</a></li>
  <li><a href="#select-rows-with-logic-ii" id="toc-select-rows-with-logic-ii" class="nav-link" data-scroll-target="#select-rows-with-logic-ii">Select Rows with Logic II</a></li>
  <li><a href="#select-rows-with-logic-iii" id="toc-select-rows-with-logic-iii" class="nav-link" data-scroll-target="#select-rows-with-logic-iii">Select Rows with Logic III</a></li>
  <li><a href="#setting-indices" id="toc-setting-indices" class="nav-link" data-scroll-target="#setting-indices">Setting indices</a></li>
  <li><a href="#bringing-it-all-together" id="toc-bringing-it-all-together" class="nav-link" data-scroll-target="#bringing-it-all-together">Bringing it all together</a></li>
  <li><a href="#modifying-dataframes---adding-a-column-i" id="toc-modifying-dataframes---adding-a-column-i" class="nav-link" data-scroll-target="#modifying-dataframes---adding-a-column-i">Modifying DataFrames - Adding a Column I</a></li>
  <li><a href="#adding-a-column-ii" id="toc-adding-a-column-ii" class="nav-link" data-scroll-target="#adding-a-column-ii">Adding a Column II</a></li>
  <li><a href="#adding-a-column-iii" id="toc-adding-a-column-iii" class="nav-link" data-scroll-target="#adding-a-column-iii">Adding a Column III</a></li>
  <li><a href="#performing-column-operations" id="toc-performing-column-operations" class="nav-link" data-scroll-target="#performing-column-operations">Performing Column Operations</a></li>
  <li><a href="#reviewing-lambda-function" id="toc-reviewing-lambda-function" class="nav-link" data-scroll-target="#reviewing-lambda-function">Reviewing Lambda Function</a></li>
  <li><a href="#reviewing-lambda-function-if-statements" id="toc-reviewing-lambda-function-if-statements" class="nav-link" data-scroll-target="#reviewing-lambda-function-if-statements">Reviewing Lambda Function: If Statements</a></li>
  <li><a href="#applying-a-lambda-to-a-column" id="toc-applying-a-lambda-to-a-column" class="nav-link" data-scroll-target="#applying-a-lambda-to-a-column">Applying a Lambda to a Column</a></li>
  <li><a href="#applying-a-lambda-to-a-row" id="toc-applying-a-lambda-to-a-row" class="nav-link" data-scroll-target="#applying-a-lambda-to-a-row">Applying a Lambda to a Row</a></li>
  <li><a href="#renaming-columns" id="toc-renaming-columns" class="nav-link" data-scroll-target="#renaming-columns">Renaming Columns</a></li>
  <li><a href="#renaming-columns-ii" id="toc-renaming-columns-ii" class="nav-link" data-scroll-target="#renaming-columns-ii">Renaming Columns II</a></li>
  <li><a href="#bringing-it-all-together-1" id="toc-bringing-it-all-together-1" class="nav-link" data-scroll-target="#bringing-it-all-together-1">Bringing it all together</a></li>
  <li><a href="#project---petal-power-inventory" id="toc-project---petal-power-inventory" class="nav-link" data-scroll-target="#project---petal-power-inventory">Project - Petal Power Inventory</a></li>
  <li><a href="#aggregates-in-pandas" id="toc-aggregates-in-pandas" class="nav-link" data-scroll-target="#aggregates-in-pandas">Aggregates in Pandas</a></li>
  <li><a href="#calculating-column-statistics" id="toc-calculating-column-statistics" class="nav-link" data-scroll-target="#calculating-column-statistics">Calculating Column Statistics</a></li>
  <li><a href="#calculating-aggregate-functions-i" id="toc-calculating-aggregate-functions-i" class="nav-link" data-scroll-target="#calculating-aggregate-functions-i">Calculating Aggregate Functions I</a></li>
  <li><a href="#calculating-aggregate-functions-ii" id="toc-calculating-aggregate-functions-ii" class="nav-link" data-scroll-target="#calculating-aggregate-functions-ii">Calculating Aggregate Functions II</a></li>
  <li><a href="#calculating-aggregate-functions-iii" id="toc-calculating-aggregate-functions-iii" class="nav-link" data-scroll-target="#calculating-aggregate-functions-iii">Calculating Aggregate Functions III</a></li>
  <li><a href="#calculating-aggregate-functions-iv" id="toc-calculating-aggregate-functions-iv" class="nav-link" data-scroll-target="#calculating-aggregate-functions-iv">Calculating Aggregate Functions IV</a></li>
  <li><a href="#pivot-tables" id="toc-pivot-tables" class="nav-link" data-scroll-target="#pivot-tables">Pivot Tables</a></li>
  <li><a href="#review" id="toc-review" class="nav-link" data-scroll-target="#review">Review</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="pandas" class="level3">
<h3 class="anchored" data-anchor-id="pandas">Pandas</h3>
<p>https://pandas.pydata.org/docs/user_guide/10min.html</p>
<p>Pandas is a very popular library for working with data (its goal is to be the most powerful and flexible open-source tool, and in our opinion, it has reached that goal). DataFrames are at the center of pandas. A DataFrame is structured like a table or spreadsheet. The rows and the columns both have indexes, and you can perform operations on rows or columns separately.</p>
<p>A pandas DataFrame can be easily changed and manipulated. Pandas has helpful functions for handling missing data, performing operations on columns and rows, and transforming data. If that wasn’t enough, a lot of SQL functions have counterparts in pandas, such as join, merge, filter by, and group by. With all of these powerful tools, it should come as no surprise that pandas is very popular among data scientists.</p>
</section>
<section id="numpy" class="level3">
<h3 class="anchored" data-anchor-id="numpy">NumPy</h3>
<p>NumPy is an open-source Python library that facilitates efficient numerical operations on large quantities of data. There are a few functions that exist in NumPy that we use on pandas DataFrames. For us, the most important part about NumPy is that pandas is built on top of it. So, NumPy is a dependency of Pandas.</p>
</section>
<section id="numpy-arrays" class="level3">
<h3 class="anchored" data-anchor-id="numpy-arrays">NumPy Arrays</h3>
<p>NumPy arrays are unique in that they are more flexible than normal Python lists. They are called ndarrays since they can have any number (n) of dimensions (d). They hold a collection of items of any one data type and can be either a vector (one-dimensional) or a matrix (multi-dimensional). NumPy arrays allow for fast element access and efficient data manipulation.</p>
<p>The code below initializes a Python list named list1:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>list1 <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To convert this to a one-dimensional ndarray with one row and four columns, we can use the <code>np.array()</code> function:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>array1 <span class="op">=</span> np.array(list1)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3 4]</code></pre>
</div>
</div>
<p>To get a two-dimensional ndarray from a list, we must start with a Python list of lists:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>list2 <span class="op">=</span> [[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],[<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>array2 <span class="op">=</span> np.array(list2)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [4 5 6]]</code></pre>
</div>
</div>
<p>In the above output, you may notice that the NumPy array print-out is displayed in a way that clearly demonstrates its multi-dimensional structure: two rows and three columns.</p>
<p>Many operations can be performed on NumPy arrays which makes them very helpful for manipulating data:</p>
<ul>
<li>Selecting array elements</li>
<li>Slicing arrays</li>
<li>Reshaping arrays</li>
<li>Splitting arrays</li>
<li>Combining arrays</li>
<li>Numerical operations (min, max, mean, etc)</li>
</ul>
<p>Mathematical operations can be performed on all values in a ndarray at one time rather than having to loop through values, as is necessary with a Python list. This is very helpful in many scenarios. Say you own a toy store and decide to decrease the price of all toys by €2 for a weekend sale. With the toy prices stored in an ndarray, you can easily facilitate this operation.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>toyPrices <span class="op">=</span> np.array([<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">6</span>])</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(toyPrices <span class="op">-</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[3 6 1 4]</code></pre>
</div>
</div>
<p>If, however, you had stored your toy prices in a Python list, you would have to manually loop through the entire list to decrease each toy price.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>toyPrices <span class="op">=</span> [<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">3</span>,<span class="dv">6</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print(toyPrices - 2) -- Not possible. Causes an error</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(toyPrices)):</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    toyPrices[i] <span class="op">-=</span> <span class="dv">2</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(toyPrices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[3, 6, 1, 4]</code></pre>
</div>
</div>
</section>
<section id="pandas-series-and-dataframes" class="level3">
<h3 class="anchored" data-anchor-id="pandas-series-and-dataframes">Pandas Series and Dataframes</h3>
<p>Just as the ndarray is the foundation of the NumPy library, the <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html">Series</a> is the core object of the pandas library. A pandas Series is very similar to a one-dimensional NumPy array, but it has additional functionality that allows values in the Series to be indexed using labels. A NumPy array does not have the flexibility to do this. This labeling is useful when you are storing pieces of data that have other data associated with them. Say you want to store the ages of students in an online course to eventually figure out the average student age. If stored in a NumPy array, you could only access these ages with the internal ndarray indices 0,1,2…. With a Series object, the indices of values are set to 0,1,2… by default, but you can customize the indices to be other values such as student names so an age can be accessed using a name. Customized indices of a Series are established by sending values into the Series constructor, as you will see below.</p>
<p>A Series holds items of any one data type and can be created by sending in a scalar value, Python list, dictionary, or ndarray as a parameter to the pandas Series constructor. If a dictionary is sent in, the keys may be used as the indices.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Series using a NumPy array of ages with the default numerical indices</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ages <span class="op">=</span> np.array([<span class="dv">13</span>,<span class="dv">25</span>,<span class="dv">19</span>])</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>series1 <span class="op">=</span> pd.Series(ages)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(series1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    13
1    25
2    19
dtype: int64</code></pre>
</div>
</div>
<p>When printing a Series, the data type of its elements is also printed. To customize the indices of a Series object, use the index argument of the Series constructor.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Series using a NumPy array of ages but customize the indices to be the names that correspond to each age</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ages <span class="op">=</span> np.array([<span class="dv">13</span>,<span class="dv">25</span>,<span class="dv">19</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>series1 <span class="op">=</span> pd.Series(ages,index<span class="op">=</span>[<span class="st">'Emma'</span>, <span class="st">'Swetha'</span>, <span class="st">'Serajh'</span>])</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(series1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Emma      13
Swetha    25
Serajh    19
dtype: int64</code></pre>
</div>
</div>
<p>Series objects provide more information than NumPy arrays do. Printing a NumPy array of ages does not print the indices or allow us to customize them.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ages <span class="op">=</span> np.array([<span class="dv">13</span>,<span class="dv">25</span>,<span class="dv">19</span>])</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[13 25 19]</code></pre>
</div>
</div>
</section>
<section id="dataframe" class="level3">
<h3 class="anchored" data-anchor-id="dataframe">DataFrame</h3>
<p>Another important type of object in the pandas library is the DataFrame. This object is similar in form to a matrix as it consists of rows and columns. Both rows and columns can be indexed with integers or String names. One DataFrame can contain many different types of data types, but within a column, everything has to be the same data type. A column of a DataFrame is essentially a Series. All columns must have the same number of elements (rows).</p>
<p>There are different ways to fill a DataFrame such as with a CSV file, a SQL query, a Python list, or a dictionary. Here we have created a DataFrame using a Python list of lists. Each nested list represents the data in one row of the DataFrame. We use the keyword columns to pass in the list of our custom column names.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dataf <span class="op">=</span> pd.DataFrame([</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'John Smith'</span>,<span class="st">'123 Main St'</span>,<span class="dv">34</span>],</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Jane Doe'</span>, <span class="st">'456 Maple Ave'</span>,<span class="dv">28</span>],</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Joe Schmo'</span>, <span class="st">'789 Broadway'</span>,<span class="dv">51</span>]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span>[<span class="st">'name'</span>,<span class="st">'address'</span>,<span class="st">'age'</span>])</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>dataf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>John Smith</td>
<td>123 Main St</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jane Doe</td>
<td>456 Maple Ave</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Joe Schmo</td>
<td>789 Broadway</td>
<td>51</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The default row indices are 0,1,2…, but these can be changed. For example, they can be set to be the elements in one of the columns of the DataFrame. To use the names column as indices instead of the default numerical values, we can run the following command on our DataFrame:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dataf.set_index(<span class="st">'name'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">John Smith</td>
<td>123 Main St</td>
<td>34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Jane Doe</td>
<td>456 Maple Ave</td>
<td>28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Joe Schmo</td>
<td>789 Broadway</td>
<td>51</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>DataFrames are useful because they make it much easier to select, manipulate, and summarize data. Their tabular format (a table with rows and columns) also makes it easier to label, simpler to read, and easier to export data to and from a spreadsheet. Understanding the power of these new data structures is the key to unlocking many new avenues for data manipulation, exploration, and analysis!</p>
</section>
<section id="create-a-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="create-a-dataframe">Create a DataFrame</h3>
<p>A DataFrame is an object that stores data as rows and columns. You can think of a DataFrame as a spreadsheet or as a SQL table. You can manually create a DataFrame or fill it with data from a CSV, an Excel spreadsheet, or a SQL query.</p>
<p>DataFrames have rows and columns. Each column has a name, which is a string. Each row has an index, which is an integer. DataFrames can contain many different data types: strings, ints, floats, tuples, etc.</p>
<p>You can pass in a dictionary to <code>pd.DataFrame()</code>. Each key is a column name and each value is a list of column values. The columns must all be the same length or you will get an error.</p>
</section>
<section id="create-a-dataframe-from-a-dictionary" class="level3">
<h3 class="anchored" data-anchor-id="create-a-dataframe-from-a-dictionary">Create a DataFrame from a dictionary</h3>
<p>You run an online clothing store called Panda’s Wardrobe. You need a DataFrame containing information about your products.</p>
<p>Create a DataFrame with the following data that your inventory manager sent you:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Product ID'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Product Name'</span>: [<span class="st">'t-shirt'</span>,<span class="st">'t-shirt'</span>,<span class="st">'skirt'</span>,<span class="st">'skirt'</span>],</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Color'</span>: [<span class="st">'blue'</span>, <span class="st">'green'</span>, <span class="st">'red'</span>, <span class="st">'black'</span>]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Product ID Product Name  Color
0           1      t-shirt   blue
1           2      t-shirt  green
2           3        skirt    red
3           4        skirt  black</code></pre>
</div>
</div>
</section>
<section id="create-a-dataframe-from-a-list-of-lists" class="level3">
<h3 class="anchored" data-anchor-id="create-a-dataframe-from-a-list-of-lists">Create a DataFrame from a list of lists [[ ]]</h3>
<p>You can also add data using lists.</p>
<p>For example, you can pass in a list of lists, where each one represents a row of data. Use the keyword argument columns to pass a list of column names.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame([</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span>, <span class="st">'San Diego'</span>, <span class="dv">100</span>],</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2</span>, <span class="st">'Los Angeles'</span>, <span class="dv">120</span>],</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">3</span>, <span class="st">'San Francisco'</span>, <span class="dv">90</span>],</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">4</span>, <span class="st">'Sacramento'</span>, <span class="dv">115</span>]</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  ],</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  columns<span class="op">=</span>[<span class="st">'Store ID'</span>,<span class="st">'Location'</span>,<span class="st">'Number of Employees'</span>])</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Store ID       Location  Number of Employees
0         1      San Diego                  100
1         2    Los Angeles                  120
2         3  San Francisco                   90
3         4     Sacramento                  115</code></pre>
</div>
</div>
</section>
<section id="comma-separated-variables-csv" class="level3">
<h3 class="anchored" data-anchor-id="comma-separated-variables-csv">Comma Separated Variables (CSV)</h3>
<p>We now know how to create our own DataFrame. However, most of the time, we’ll be working with datasets that already exist. One of the most common formats for big datasets is the CSV.</p>
<p>CSV (comma separated values) is a text-only spreadsheet format. You can find CSVs in lots of places:</p>
<ul>
<li>Online datasets (here’s an example from <a href="https://catalog.data.gov/dataset?res_format=CSV">data.gov</a>)</li>
<li>Export from Excel or Google Sheets</li>
<li>Export from SQL</li>
</ul>
<p>The first row of a CSV contains column headings. All subsequent rows contain values. Each column heading and each variable is separated by a comma:</p>
<pre><code>column1,column2,column3
value1,value2,value3</code></pre>
</section>
<section id="loading-and-saving-csvs" class="level3">
<h3 class="anchored" data-anchor-id="loading-and-saving-csvs">Loading and Saving CSVs</h3>
<p>When you have data in a CSV, you can load it into a DataFrame in Pandas using <code>.read_csv()</code>:</p>
<pre><code>pd.read_csv('my-csv-file.csv')</code></pre>
<p>n the example above, the <code>.read_csv()</code> method is called. The CSV file called my-csv-file is passed in as an argument.</p>
<p>We can also save data to a CSV, using <code>.to_csv()</code>.</p>
<pre><code>df.to_csv('new-csv-file.csv')</code></pre>
<p>In the example above, the <code>.to_csv()</code> method is called on df (which represents a DataFrame object). The name of the CSV file is passed in as an argument (new-csv-file.csv). By default, this method will save the CSV file in your current directory.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/sample.csv'</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Population</th>
<th data-quarto-table-cell-role="th">Median Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Maplewood</td>
<td>100000</td>
<td>40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Wayne</td>
<td>350000</td>
<td>33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Forrest Hills</td>
<td>300000</td>
<td>35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Paramus</td>
<td>400000</td>
<td>55</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Hackensack</td>
<td>290000</td>
<td>39</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="inspect-a-dataframe" class="level3">
<h3 class="anchored" data-anchor-id="inspect-a-dataframe">Inspect a DataFrame</h3>
<p>When we load a new DataFrame from a CSV, we want to know what it looks like.</p>
<p>If it’s a small DataFrame, you can display it by typing print(df).</p>
<p>If it’s a larger DataFrame, it’s helpful to be able to inspect a few items without having to look at the entire DataFrame.</p>
<p>The method <code>.head()</code> gives the first 5 rows of a DataFrame. If you want to see more rows, you can pass in the positional argument n.&nbsp;For example, <code>df.head(10)</code> would show the first 10 rows.</p>
<p>The method <code>df.info()</code> gives some statistics for each column.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/imdb.csv'</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">genre</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Avatar</td>
<td>action</td>
<td>2009</td>
<td>7.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Jurassic World</td>
<td>action</td>
<td>2015</td>
<td>7.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>The Avengers</td>
<td>action</td>
<td>2012</td>
<td>8.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>The Dark Knight</td>
<td>action</td>
<td>2008</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Star Wars: Episode I - The Phantom Menace</td>
<td>action</td>
<td>1999</td>
<td>6.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">215</td>
<td>216</td>
<td>Hannibal</td>
<td>drama</td>
<td>2001</td>
<td>6.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">216</td>
<td>217</td>
<td>Catch Me If You Can</td>
<td>drama</td>
<td>2002</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">217</td>
<td>218</td>
<td>Big Daddy</td>
<td>drama</td>
<td>1999</td>
<td>6.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">218</td>
<td>219</td>
<td>Se7en</td>
<td>drama</td>
<td>1995</td>
<td>8.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">219</td>
<td>220</td>
<td>Seven</td>
<td>drama</td>
<td>1979</td>
<td>6.1</td>
</tr>
</tbody>
</table>

<p>220 rows × 5 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">genre</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Avatar</td>
<td>action</td>
<td>2009</td>
<td>7.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Jurassic World</td>
<td>action</td>
<td>2015</td>
<td>7.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>The Avengers</td>
<td>action</td>
<td>2012</td>
<td>8.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>The Dark Knight</td>
<td>action</td>
<td>2008</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Star Wars: Episode I - The Phantom Menace</td>
<td>action</td>
<td>1999</td>
<td>6.6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 220 entries, 0 to 219
Data columns (total 5 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   id           220 non-null    int64  
 1   name         220 non-null    object 
 2   genre        220 non-null    object 
 3   year         220 non-null    int64  
 4   imdb_rating  220 non-null    float64
dtypes: float64(1), int64(2), object(2)
memory usage: 8.7+ KB</code></pre>
</div>
</div>
</section>
<section id="select-columns" class="level3">
<h3 class="anchored" data-anchor-id="select-columns">Select Columns</h3>
<p>Now we know how to create and load data. Let’s select parts of those datasets that are interesting or important to our analyses.</p>
<p>Suppose you have the DataFrame called customers, which contains the ages of your customers:</p>
<pre><code>name    age
Rebecca Erikson 35
Thomas Roberson 28
Diane Ochoa 42
…   …</code></pre>
<p>Perhaps you want to take the average or plot a histogram of the ages. In order to do either of these tasks, you’d need to select the column.</p>
<p>There are two possible syntaxes for selecting all values from a column:</p>
<ol type="1">
<li><p>Select the column as if you were selecting a value from a dictionary using a key. In our example, we would type <code>customers['age']</code> to select the ages.</p></li>
<li><p>If the name of a column follows all of the rules for a variable name (doesn’t start with a number, doesn’t contain spaces or special characters, etc.), then you can select it using the following notation: <code>df.MySecondColumn</code>. In our example, we would type customers.age.</p></li>
</ol>
<p>When we select a single column, the result is called a Series.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame([</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'January'</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">23</span>, <span class="dv">100</span>],</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'February'</span>, <span class="dv">51</span>, <span class="dv">45</span>, <span class="dv">145</span>, <span class="dv">45</span>],</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'March'</span>, <span class="dv">81</span>, <span class="dv">96</span>, <span class="dv">65</span>, <span class="dv">96</span>],</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'April'</span>, <span class="dv">80</span>, <span class="dv">80</span>, <span class="dv">54</span>, <span class="dv">180</span>],</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'May'</span>, <span class="dv">51</span>, <span class="dv">54</span>, <span class="dv">54</span>, <span class="dv">154</span>],</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'June'</span>, <span class="dv">112</span>, <span class="dv">109</span>, <span class="dv">79</span>, <span class="dv">129</span>]],</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  columns<span class="op">=</span>[<span class="st">'month'</span>, <span class="st">'clinic_east'</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">'clinic_north'</span>, <span class="st">'clinic_south'</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">'clinic_west'</span>]</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">clinic_east</th>
<th data-quarto-table-cell-role="th">clinic_north</th>
<th data-quarto-table-cell-role="th">clinic_south</th>
<th data-quarto-table-cell-role="th">clinic_west</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>January</td>
<td>100</td>
<td>100</td>
<td>23</td>
<td>100</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>February</td>
<td>51</td>
<td>45</td>
<td>145</td>
<td>45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>March</td>
<td>81</td>
<td>96</td>
<td>65</td>
<td>96</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>April</td>
<td>80</td>
<td>80</td>
<td>54</td>
<td>180</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>May</td>
<td>51</td>
<td>54</td>
<td>54</td>
<td>154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>June</td>
<td>112</td>
<td>109</td>
<td>79</td>
<td>129</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The DataFrame df represents data collected by four health clinics run by the same organization. Each row represents a month from January through June and shows the number of appointments made at four different clinics.</p>
<p>You want to analyze what’s been happening at the North location. Create a variable called <code>clinic_north</code> that contains ONLY the data from the column <code>clinic_north</code>.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>clinic_north <span class="op">=</span> df.clinic_north</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>clinic_north</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>0    100
1     45
2     96
3     80
4     54
5    109
Name: clinic_north, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(clinic_north)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>pandas.core.series.Series</code></pre>
</div>
</div>
</section>
<section id="selecting-multiple-columns" class="level3">
<h3 class="anchored" data-anchor-id="selecting-multiple-columns">Selecting Multiple Columns</h3>
<p>When you have a larger DataFrame, you might want to select just a few columns. To select two or more columns from a DataFrame, we use a list of the column names, for example :</p>
<pre><code>new_df = orders[['last_name', 'email']]</code></pre>
<blockquote class="blockquote">
<p>Note: Make sure that you have a double set of brackets ([[ ]]), or this command won’t work!</p>
</blockquote>
<p>Now, you want to compare visits to the Northern and Southern clinics.</p>
<p>Create a variable called <code>clinic_north_south</code> that contains ONLY the data from the columns <code>clinic_north</code> and <code>clinic_south</code>.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>clinic_north_south <span class="op">=</span> df[[<span class="st">'clinic_north'</span>,<span class="st">'clinic_south'</span>]]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>clinic_north_south</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">clinic_north</th>
<th data-quarto-table-cell-role="th">clinic_south</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>45</td>
<td>145</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>96</td>
<td>65</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>80</td>
<td>54</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>54</td>
<td>54</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>109</td>
<td>79</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(clinic_north_south)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
</section>
<section id="select-rows" class="level3">
<h3 class="anchored" data-anchor-id="select-rows">Select Rows</h3>
<p>DataFrames are zero-indexed, meaning that we start with the 0th row and count up from there. For example to select the 3rd row we select it using the following command:</p>
<pre><code>df.iloc[2]</code></pre>
<p>When we select a single row, the result is a Series (just like when we select a single column).</p>
<p>Write a command that will produce a Series made up of the March data from df from all four clinic sites and save it to the variable <code>march</code>.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>march <span class="op">=</span> df.iloc[<span class="dv">2</span>]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>march</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>month           March
clinic_east        81
clinic_north       96
clinic_south       65
clinic_west        96
Name: 2, dtype: object</code></pre>
</div>
</div>
</section>
<section id="selecting-multiple-rows" class="level3">
<h3 class="anchored" data-anchor-id="selecting-multiple-rows">Selecting Multiple Rows</h3>
<p>Here are some different ways of selecting multiple rows:</p>
<ul>
<li><p>df.iloc[3:7] would select all rows starting at the 3rd row and up to but not including the 7th row (i.e., the 3rd row, 4th row, 5th row, and 6th row)</p></li>
<li><p>df.iloc[:4] would select all rows up to, but not including the 4th row (i.e., the 0th, 1st, 2nd, and 3rd rows)</p></li>
<li><p>df.iloc[-3:] would select the rows starting at the 3rd to last row and up to and including the final row</p></li>
</ul>
<p>One of your doctors thinks that there are more clinic visits in the late Spring.</p>
<p>Write a command that will produce a DataFrame made up of the data for April, May, and June from df for all four sites (rows 3 through 6), and save it to <code>april_may_june</code>.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>april_may_june <span class="op">=</span> df.iloc[<span class="dv">3</span>:<span class="dv">6</span>]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>april_may_june</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">clinic_east</th>
<th data-quarto-table-cell-role="th">clinic_north</th>
<th data-quarto-table-cell-role="th">clinic_south</th>
<th data-quarto-table-cell-role="th">clinic_west</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>April</td>
<td>80</td>
<td>80</td>
<td>54</td>
<td>180</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>May</td>
<td>51</td>
<td>54</td>
<td>54</td>
<td>154</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>June</td>
<td>112</td>
<td>109</td>
<td>79</td>
<td>129</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="select-rows-with-logic-i" class="level3">
<h3 class="anchored" data-anchor-id="select-rows-with-logic-i">Select Rows with Logic I</h3>
<p>You can select a subset of a DataFrame by using logical statements:</p>
<pre><code>df[df.MyColumnName == desired_column_value]</code></pre>
<p>Suppose we want to select all rows where the customer’s age is 30. We would use:</p>
<pre><code>df[df.age == 30]</code></pre>
<p>We can use other logical statements, such as:</p>
<ul>
<li><p>Greater Than, &gt; — Here, we select all rows where the customer’s age is greater than 30</p>
<p>df[df.age &gt; 30]</p></li>
<li><p>Less Than, &lt; — Here, we select all rows where the customer’s age is less than 30:</p>
<p>df[df.age &lt; 30]</p></li>
<li><p>Not Equal, != — This snippet selects all rows where the customer’s name is not Clara Oswald:</p>
<p>df[df.name != ‘Clara Oswald’]</p></li>
</ul>
<p>You’re going to staff the clinic for January of this year. You want to know how many visits took place in January of last year, to help you prepare.</p>
<p>Create variable <code>january</code> using a logical statement that selects the row of df where the ‘month’ column is ‘January’.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>january <span class="op">=</span> df[df.month <span class="op">==</span> <span class="st">'January'</span>]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>january</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">clinic_east</th>
<th data-quarto-table-cell-role="th">clinic_north</th>
<th data-quarto-table-cell-role="th">clinic_south</th>
<th data-quarto-table-cell-role="th">clinic_west</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>January</td>
<td>100</td>
<td>100</td>
<td>23</td>
<td>100</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="select-rows-with-logic-ii" class="level3">
<h3 class="anchored" data-anchor-id="select-rows-with-logic-ii">Select Rows with Logic II</h3>
<p>You can also combine multiple logical statements, as long as each statement is in parentheses.</p>
<p>For instance, suppose we wanted to select all rows where the customer’s age was under 30 or the customer’s name was “Martha Jones”:</p>
<p>We could use the following code:</p>
<pre><code>df[(df.age &lt; 30) | (df.name == 'Martha Jones')]</code></pre>
<p>In Python, | means “or” and &amp; means “and”.</p>
<p>You want to see how the number of clinic visits changed between March and April.</p>
<p>Create the variable <code>march_april</code>, which contains the data from March and April. Do this using two logical statements combined using |, which means “or”.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>march_april <span class="op">=</span> df[(df.month <span class="op">==</span> <span class="st">'March'</span>) <span class="op">|</span> (df.month <span class="op">==</span> <span class="st">'April'</span>)]</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>march_april</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">clinic_east</th>
<th data-quarto-table-cell-role="th">clinic_north</th>
<th data-quarto-table-cell-role="th">clinic_south</th>
<th data-quarto-table-cell-role="th">clinic_west</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>March</td>
<td>81</td>
<td>96</td>
<td>65</td>
<td>96</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>April</td>
<td>80</td>
<td>80</td>
<td>54</td>
<td>180</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="select-rows-with-logic-iii" class="level3">
<h3 class="anchored" data-anchor-id="select-rows-with-logic-iii">Select Rows with Logic III</h3>
<p>Suppose we want to select the rows where the customer’s name is either “Martha Jones”, “Rose Tyler” or “Amy Pond”.</p>
<p>We could use the <code>isin</code> command to check that df.name is one of a list of values:</p>
<pre><code>df[df.name.isin(['Martha Jones', 'Rose Tyler','Amy Pond'])]</code></pre>
<p>Another doctor thinks that you have a lot of clinic visits in the late Winter.</p>
<p>Create the variable <code>january_february_march</code>, containing the data from January, February, and March. Do this using a single logical statement with the isin command.</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>january_february_march <span class="op">=</span> df[df.month.isin([<span class="st">'January'</span>, <span class="st">'February'</span>, <span class="st">'March'</span>])]</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>january_february_march</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">clinic_east</th>
<th data-quarto-table-cell-role="th">clinic_north</th>
<th data-quarto-table-cell-role="th">clinic_south</th>
<th data-quarto-table-cell-role="th">clinic_west</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>January</td>
<td>100</td>
<td>100</td>
<td>23</td>
<td>100</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>February</td>
<td>51</td>
<td>45</td>
<td>145</td>
<td>45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>March</td>
<td>81</td>
<td>96</td>
<td>65</td>
<td>96</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="setting-indices" class="level3">
<h3 class="anchored" data-anchor-id="setting-indices">Setting indices</h3>
<p>When we select a subset of a DataFrame using logic, we end up with non-consecutive indices. This is inelegant and makes it hard to use <code>.iloc()</code>.</p>
<p>We can fix this using the method <code>.reset_index()</code>. For example, here is a DataFrame called df with non-consecutive indices:</p>
<pre><code>First Name  Last Name
0   John    Smith
4   Jane    Doe
7   Joe Schmo</code></pre>
<p>If we use the command <code>df.reset_index()</code>, we get a new DataFrame with a new set of indices:</p>
<pre><code>index   First Name  Last Name
0   0   John    Smith
1   4   Jane    Doe
2   7   Joe Schmo</code></pre>
<p>Note that the old indices have been moved into a new column called ‘index’. Unless you need those values for something special, it’s probably better to use the keyword <code>drop=True</code> so that you don’t end up with that extra column. If we run the command <code>df.reset_index(drop=True)</code>, we get a new DataFrame that looks like this:</p>
<pre><code>First Name  Last Name
0   John    Smith
1   Jane    Doe
2   Joe Schmo</code></pre>
<p>Using <code>.reset_index()</code> will return a <strong>new</strong> DataFrame, but we usually just want to modify our existing DataFrame. If we use the keyword <code>inplace=True</code> we can just modify our existing DataFrame.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df.loc[[<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>]]</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">clinic_east</th>
<th data-quarto-table-cell-role="th">clinic_north</th>
<th data-quarto-table-cell-role="th">clinic_south</th>
<th data-quarto-table-cell-role="th">clinic_west</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>February</td>
<td>51</td>
<td>45</td>
<td>145</td>
<td>45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>April</td>
<td>80</td>
<td>80</td>
<td>54</td>
<td>180</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>June</td>
<td>112</td>
<td>109</td>
<td>79</td>
<td>129</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Create a new DataFrame called <code>df3</code> by resetting the indices on df2 (don’t use inplace or drop). Did df2 change after you ran this command?</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> df2.reset_index()</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>df3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">clinic_east</th>
<th data-quarto-table-cell-role="th">clinic_north</th>
<th data-quarto-table-cell-role="th">clinic_south</th>
<th data-quarto-table-cell-role="th">clinic_west</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>February</td>
<td>51</td>
<td>45</td>
<td>145</td>
<td>45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3</td>
<td>April</td>
<td>80</td>
<td>80</td>
<td>54</td>
<td>180</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5</td>
<td>June</td>
<td>112</td>
<td>109</td>
<td>79</td>
<td>129</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note that df2 remains unchanged as we did not specify <code>inplace=True</code> and the old indexes remain as we did not specify <code>drop=True</code>.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">clinic_east</th>
<th data-quarto-table-cell-role="th">clinic_north</th>
<th data-quarto-table-cell-role="th">clinic_south</th>
<th data-quarto-table-cell-role="th">clinic_west</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>February</td>
<td>51</td>
<td>45</td>
<td>145</td>
<td>45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>April</td>
<td>80</td>
<td>80</td>
<td>54</td>
<td>180</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>June</td>
<td>112</td>
<td>109</td>
<td>79</td>
<td>129</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Reset the indices of df2 by using the keyword inplace=True and drop=True. Did the indices of df2 change? How is df2 different from df3?</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df2.reset_index(drop<span class="op">=</span><span class="va">True</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">clinic_east</th>
<th data-quarto-table-cell-role="th">clinic_north</th>
<th data-quarto-table-cell-role="th">clinic_south</th>
<th data-quarto-table-cell-role="th">clinic_west</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>February</td>
<td>51</td>
<td>45</td>
<td>145</td>
<td>45</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>April</td>
<td>80</td>
<td>80</td>
<td>54</td>
<td>180</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>June</td>
<td>112</td>
<td>109</td>
<td>79</td>
<td>129</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="bringing-it-all-together" class="level3">
<h3 class="anchored" data-anchor-id="bringing-it-all-together">Bringing it all together</h3>
<blockquote class="blockquote">
<p>In this example, you’ll be the data analyst for ShoeFly.com, a fictional online shoe store. You’ve seen this data; now it’s your turn to work with it! Load the data from shoefly.csv into the variable orders.</p>
</blockquote>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>orders <span class="op">=</span> pd.read_csv(<span class="st">'data/shoefly.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Inspect the first 5 lines of the data.</p>
</blockquote>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>orders.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">last_name</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_material</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>54791</td>
<td>Rebecca</td>
<td>Lindsay</td>
<td>RebeccaLindsay57@hotmail.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>black</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>53450</td>
<td>Emily</td>
<td>Joyce</td>
<td>EmilyJoyce25@gmail.com</td>
<td>ballet flats</td>
<td>faux-leather</td>
<td>navy</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>91987</td>
<td>Joyce</td>
<td>Waller</td>
<td>Joyce.Waller@gmail.com</td>
<td>sandals</td>
<td>fabric</td>
<td>black</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>14437</td>
<td>Justin</td>
<td>Erickson</td>
<td>Justin.Erickson@outlook.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>red</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>79357</td>
<td>Andrew</td>
<td>Banks</td>
<td>AB4318@gmail.com</td>
<td>boots</td>
<td>leather</td>
<td>brown</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Your marketing department wants to send out an email blast to everyone who ordered shoes! Select all of the email addresses from the column email and save them to a variable called emails.</p>
</blockquote>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>emails <span class="op">=</span> orders.email</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>emails</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>0     RebeccaLindsay57@hotmail.com
1           EmilyJoyce25@gmail.com
2           Joyce.Waller@gmail.com
3      Justin.Erickson@outlook.com
4                 AB4318@gmail.com
5           JulieMarsh59@gmail.com
6                 TJ5470@gmail.com
7           Janice.Hicks@gmail.com
8        GabrielPorter24@gmail.com
9        FrancesPalmer50@gmail.com
10         JessicaHale25@gmail.com
11      LawrenceParker44@gmail.com
12         SusanDennis58@gmail.com
13                DO2680@gmail.com
14       Rebecca.Charles@gmail.com
15              JC2072@hotmail.com
16              VS4753@outlook.com
17          RoyTillman20@gmail.com
18       Thomas.Roberson@gmail.com
19         ANewton1977@outlook.com
Name: email, dtype: object</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Frances Palmer claims that her order was wrong. What did Frances Palmer order? Use logic to select that row of orders and save it to the variable frances_palmer.</p>
</blockquote>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>frances_palmer <span class="op">=</span> orders[(orders.first_name <span class="op">==</span> <span class="st">'Frances'</span>) <span class="op">&amp;</span> (orders.last_name <span class="op">==</span> <span class="st">'Palmer'</span>)]</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>frances_palmer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">last_name</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_material</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>62083</td>
<td>Frances</td>
<td>Palmer</td>
<td>FrancesPalmer50@gmail.com</td>
<td>wedges</td>
<td>leather</td>
<td>white</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>We need some customer reviews for our comfortable shoes. Select all orders for shoe_type: clogs, boots, and ballet flats and save them to the variable comfy_shoes.</p>
</blockquote>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>comfy_shoes <span class="op">=</span> orders[orders.shoe_type.isin([<span class="st">'clogs'</span>, <span class="st">'boots'</span>, <span class="st">'ballet flats'</span>])]</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>comfy_shoes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">last_name</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_material</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>54791</td>
<td>Rebecca</td>
<td>Lindsay</td>
<td>RebeccaLindsay57@hotmail.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>black</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>53450</td>
<td>Emily</td>
<td>Joyce</td>
<td>EmilyJoyce25@gmail.com</td>
<td>ballet flats</td>
<td>faux-leather</td>
<td>navy</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>14437</td>
<td>Justin</td>
<td>Erickson</td>
<td>Justin.Erickson@outlook.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>red</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>79357</td>
<td>Andrew</td>
<td>Banks</td>
<td>AB4318@gmail.com</td>
<td>boots</td>
<td>leather</td>
<td>brown</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>20487</td>
<td>Thomas</td>
<td>Jensen</td>
<td>TJ5470@gmail.com</td>
<td>clogs</td>
<td>fabric</td>
<td>navy</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>76971</td>
<td>Janice</td>
<td>Hicks</td>
<td>Janice.Hicks@gmail.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>navy</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>21586</td>
<td>Gabriel</td>
<td>Porter</td>
<td>GabrielPorter24@gmail.com</td>
<td>clogs</td>
<td>leather</td>
<td>brown</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>91629</td>
<td>Jessica</td>
<td>Hale</td>
<td>JessicaHale25@gmail.com</td>
<td>clogs</td>
<td>leather</td>
<td>red</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>45832</td>
<td>Susan</td>
<td>Dennis</td>
<td>SusanDennis58@gmail.com</td>
<td>ballet flats</td>
<td>fabric</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">14</td>
<td>73431</td>
<td>Rebecca</td>
<td>Charles</td>
<td>Rebecca.Charles@gmail.com</td>
<td>boots</td>
<td>faux-leather</td>
<td>white</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>39888</td>
<td>Vincent</td>
<td>Stephenson</td>
<td>VS4753@outlook.com</td>
<td>boots</td>
<td>leather</td>
<td>black</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>35961</td>
<td>Roy</td>
<td>Tillman</td>
<td>RoyTillman20@gmail.com</td>
<td>boots</td>
<td>leather</td>
<td>white</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="modifying-dataframes---adding-a-column-i" class="level3">
<h3 class="anchored" data-anchor-id="modifying-dataframes---adding-a-column-i">Modifying DataFrames - Adding a Column I</h3>
<p>Sometimes, we want to add a column to an existing DataFrame. We might want to add new information or perform a calculation based on the data that we already have.</p>
<p>One way that we can add a new column is by giving a list of the same length as the existing DataFrame. e.g</p>
<pre><code>df['Quantity'] = [100, 150, 50, 35]</code></pre>
<p>The DataFrame df contains information on products sold at a hardware store.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame([</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">1</span>, <span class="st">'3 inch screw'</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>],</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">2</span>, <span class="st">'2 inch nail'</span>, <span class="fl">0.10</span>, <span class="fl">0.25</span>],</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">3</span>, <span class="st">'hammer'</span>, <span class="fl">3.00</span>, <span class="fl">5.50</span>],</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">4</span>, <span class="st">'screwdriver'</span>, <span class="fl">2.50</span>, <span class="fl">3.00</span>]</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>],</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  columns<span class="op">=</span>[<span class="st">'Product ID'</span>, <span class="st">'Description'</span>, <span class="st">'Cost to Manufacture'</span>, <span class="st">'Price'</span>]</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Product ID   Description  Cost to Manufacture  Price
0           1  3 inch screw                  0.5   0.75
1           2   2 inch nail                  0.1   0.25
2           3        hammer                  3.0   5.50
3           4   screwdriver                  2.5   3.00</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Add a column to df called ‘Sold in Bulk?’, which indicates if the product is sold in bulk or individually :</p>
</blockquote>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Sold in Bulk?'</span>] <span class="op">=</span> [<span class="st">'Yes'</span>, <span class="st">'Yes'</span>, <span class="st">'No'</span>, <span class="st">'No'</span>]</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Product ID   Description  Cost to Manufacture  Price Sold in Bulk?
0           1  3 inch screw                  0.5   0.75           Yes
1           2   2 inch nail                  0.1   0.25           Yes
2           3        hammer                  3.0   5.50            No
3           4   screwdriver                  2.5   3.00            No</code></pre>
</div>
</div>
</section>
<section id="adding-a-column-ii" class="level3">
<h3 class="anchored" data-anchor-id="adding-a-column-ii">Adding a Column II</h3>
<p>We can also add a new column that is the same for all rows in the DataFrame. Let’s return to our inventory example. Suppose we know that all of our products are currently in-stock. We can add a column that says this:</p>
<pre><code>df['In Stock?'] = True</code></pre>
<p>Now all of the rows have a column called In Stock? with value True.</p>
<blockquote class="blockquote">
<p>Q. Add a column to df called Is taxed?, which indicates whether or not to collect sales tax on the product. It should be ‘Yes’ for all rows.</p>
</blockquote>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Is taxed?'</span>] <span class="op">=</span> <span class="st">'Yes'</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Product ID   Description  Cost to Manufacture  Price Sold in Bulk?  \
0           1  3 inch screw                  0.5   0.75           Yes   
1           2   2 inch nail                  0.1   0.25           Yes   
2           3        hammer                  3.0   5.50            No   
3           4   screwdriver                  2.5   3.00            No   

  Is taxed?  
0       Yes  
1       Yes  
2       Yes  
3       Yes  </code></pre>
</div>
</div>
</section>
<section id="adding-a-column-iii" class="level3">
<h3 class="anchored" data-anchor-id="adding-a-column-iii">Adding a Column III</h3>
<p>Finally, you can add a new column by performing a function on the existing columns.</p>
<p>Maybe we want to add a column to our inventory table with the amount of sales tax that we need to charge for each item. The following code multiplies each Price by 0.075, the sales tax for our state:</p>
<pre><code>df['Sales Tax'] = df.Price * 0.075</code></pre>
<blockquote class="blockquote">
<p>Q. Add a column to df called ‘Margin’, which is equal to the difference between the Price and the Cost to Manufacture.</p>
</blockquote>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Margin'</span>] <span class="op">=</span> df.Price <span class="op">-</span> df[<span class="st">'Cost to Manufacture'</span>]</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Product ID   Description  Cost to Manufacture  Price Sold in Bulk?  \
0           1  3 inch screw                  0.5   0.75           Yes   
1           2   2 inch nail                  0.1   0.25           Yes   
2           3        hammer                  3.0   5.50            No   
3           4   screwdriver                  2.5   3.00            No   

  Is taxed?  Margin  
0       Yes    0.25  
1       Yes    0.15  
2       Yes    2.50  
3       Yes    0.50  </code></pre>
</div>
</div>
</section>
<section id="performing-column-operations" class="level3">
<h3 class="anchored" data-anchor-id="performing-column-operations">Performing Column Operations</h3>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame([</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'JOHN SMITH'</span>, <span class="st">'john.smith@gmail.com'</span>],</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'Jane Doe'</span>, <span class="st">'jdoe@yahoo.com'</span>],</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  [<span class="st">'joe schmo'</span>, <span class="st">'joeschmo@hotmail.com'</span>]</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>],</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>columns<span class="op">=</span>[<span class="st">'Name'</span>, <span class="st">'Email'</span>])</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>JOHN SMITH</td>
<td>john.smith@gmail.com</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jane Doe</td>
<td>jdoe@yahoo.com</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>joe schmo</td>
<td>joeschmo@hotmail.com</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In the previous exercise, we learned how to add columns to a DataFrame.</p>
<p>Often, the column that we want to add is related to existing columns, but requires a calculation more complex than multiplication or addition.</p>
<p>We can use the apply function to apply a function to every value in a particular column. For example, this code overwrites the existing ‘Name’ columns by applying the function upper to every row in ‘Name’.</p>
<pre><code>df['Name'] = df.Name.apply(str.upper)</code></pre>
<blockquote class="blockquote">
<p>Q. Apply the function lower to all names in column ‘Name’ in df. Assign these new names to a new column of df called ‘Lowercase Name’. The final DataFrame should look like this:</p>
</blockquote>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Lowercase Name'</span>] <span class="op">=</span> df.Name.<span class="bu">apply</span>(<span class="bu">str</span>.lower)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Email</th>
<th data-quarto-table-cell-role="th">Lowercase Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>JOHN SMITH</td>
<td>john.smith@gmail.com</td>
<td>john smith</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jane Doe</td>
<td>jdoe@yahoo.com</td>
<td>jane doe</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>joe schmo</td>
<td>joeschmo@hotmail.com</td>
<td>joe schmo</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="reviewing-lambda-function" class="level3">
<h3 class="anchored" data-anchor-id="reviewing-lambda-function">Reviewing Lambda Function</h3>
<p>Lambda functions work with all types of variables, not just integers! Here is an example that takes in a string, assigns it to the temporary variable x, and then converts it into lowercase:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>stringlambda <span class="op">=</span> <span class="kw">lambda</span> x: x.lower()</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(stringlambda(<span class="st">"Oh Hi Mark!"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>oh hi mark!</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Create a lambda function <code>mylambda</code> that returns the first and last letters of a string, assuming the string is at least 2 characters long.</p>
</blockquote>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>mylambda <span class="op">=</span> <span class="kw">lambda</span> x: x[<span class="dv">0</span>] <span class="op">+</span> x[<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mylambda(<span class="st">'This is a string'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tg</code></pre>
</div>
</div>
</section>
<section id="reviewing-lambda-function-if-statements" class="level3">
<h3 class="anchored" data-anchor-id="reviewing-lambda-function-if-statements">Reviewing Lambda Function: If Statements</h3>
<p>We can make our lambdas more complex by using a modified form of an if statement.</p>
<p>Suppose we want to pay workers time-and-a-half for overtime (any work above 40 hours per week). The following function will convert the number of hours into time-and-a-half hours using an if statement:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> myfunction(x):</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">40</span>:</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">40</span> <span class="op">+</span> (x <span class="op">-</span> <span class="dv">40</span>) <span class="op">*</span> <span class="fl">1.50</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below is a lambda function that does the same thing:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>myfunction <span class="op">=</span> <span class="kw">lambda</span> x: <span class="dv">40</span> <span class="op">+</span> (x <span class="op">-</span> <span class="dv">40</span>) <span class="op">*</span> <span class="fl">1.50</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">40</span> <span class="cf">else</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>myfunction(<span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>55.0</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. You are managing the webpage of a somewhat violent video game and you want to check that each user’s age is 13 or greater when they visit the site. Write a lambda function that takes an inputted age and either returns <code>Welcome to BattleCity!</code> if the user is 13 or older or <code>You must be 13 or older</code> if they are younger than 13. Your lambda function should be called <code>mylambda</code>.</p>
</blockquote>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>mylambda <span class="op">=</span> <span class="kw">lambda</span> age: <span class="st">'Welcome to BattleCity!'</span> <span class="cf">if</span> age <span class="op">&gt;=</span> <span class="dv">13</span> <span class="cf">else</span> <span class="st">'You must be 13 or older'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>mylambda(<span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>'Welcome to BattleCity!'</code></pre>
</div>
</div>
</section>
<section id="applying-a-lambda-to-a-column" class="level3">
<h3 class="anchored" data-anchor-id="applying-a-lambda-to-a-column">Applying a Lambda to a Column</h3>
<p>In Pandas, we often use lambda functions to perform complex operations on columns. For example, suppose that we want to create a column containing the email provider for each email address in a table.</p>
<p>We could use the following code with a lambda function and the string method .split():</p>
<pre><code>df['Email Provider'] = df.Email.apply(
lambda x: x.split('@')[-1]
)</code></pre>
<blockquote class="blockquote">
<p>Q. Create a lambda function <code>get_last_name</code> which takes a string with someone’s first and last name (i.e., John Smith), and returns just the last name (i.e., Smith).</p>
</blockquote>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>get_last_name <span class="op">=</span> <span class="kw">lambda</span> name: name.split(<span class="st">' '</span>)[<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(get_last_name(<span class="st">'John Smith'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Smith</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/employees.csv'</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">hourly_wage</th>
<th data-quarto-table-cell-role="th">hours_worked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10310</td>
<td>Lauren Durham</td>
<td>19</td>
<td>43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>18656</td>
<td>Grace Sellers</td>
<td>17</td>
<td>40</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>61254</td>
<td>Shirley Rasmussen</td>
<td>16</td>
<td>30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>16886</td>
<td>Brian Rojas</td>
<td>18</td>
<td>47</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>89010</td>
<td>Samantha Mosley</td>
<td>11</td>
<td>38</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>87246</td>
<td>Louis Guzman</td>
<td>14</td>
<td>39</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>20578</td>
<td>Denise Mcclure</td>
<td>15</td>
<td>40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>12869</td>
<td>James Raymond</td>
<td>15</td>
<td>32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>53461</td>
<td>Noah Collier</td>
<td>18</td>
<td>35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>14746</td>
<td>Donna Frederick</td>
<td>20</td>
<td>41</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>71127</td>
<td>Shirley Beck</td>
<td>14</td>
<td>32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>92522</td>
<td>Christina Kelly</td>
<td>8</td>
<td>44</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>22447</td>
<td>Brian Noble</td>
<td>11</td>
<td>39</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>61654</td>
<td>Randy Key</td>
<td>16</td>
<td>38</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>16988</td>
<td>Diana Stewart</td>
<td>14</td>
<td>48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>68619</td>
<td>Timothy Sosa</td>
<td>14</td>
<td>42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>59949</td>
<td>Betty Skinner</td>
<td>11</td>
<td>48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>81418</td>
<td>Janet Maxwell</td>
<td>12</td>
<td>38</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>27267</td>
<td>Madison Johnston</td>
<td>20</td>
<td>37</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>19985</td>
<td>Virginia Nichols</td>
<td>13</td>
<td>49</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Use the lambda function <code>get_last_name</code> to create a new column <code>last_name</code> with only the employees’ last name.</p>
</blockquote>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'last_name'</span>] <span class="op">=</span> df.name.<span class="bu">apply</span>(get_last_name)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">hourly_wage</th>
<th data-quarto-table-cell-role="th">hours_worked</th>
<th data-quarto-table-cell-role="th">last_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10310</td>
<td>Lauren Durham</td>
<td>19</td>
<td>43</td>
<td>Durham</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>18656</td>
<td>Grace Sellers</td>
<td>17</td>
<td>40</td>
<td>Sellers</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>61254</td>
<td>Shirley Rasmussen</td>
<td>16</td>
<td>30</td>
<td>Rasmussen</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>16886</td>
<td>Brian Rojas</td>
<td>18</td>
<td>47</td>
<td>Rojas</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>89010</td>
<td>Samantha Mosley</td>
<td>11</td>
<td>38</td>
<td>Mosley</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>87246</td>
<td>Louis Guzman</td>
<td>14</td>
<td>39</td>
<td>Guzman</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>20578</td>
<td>Denise Mcclure</td>
<td>15</td>
<td>40</td>
<td>Mcclure</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>12869</td>
<td>James Raymond</td>
<td>15</td>
<td>32</td>
<td>Raymond</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>53461</td>
<td>Noah Collier</td>
<td>18</td>
<td>35</td>
<td>Collier</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>14746</td>
<td>Donna Frederick</td>
<td>20</td>
<td>41</td>
<td>Frederick</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>71127</td>
<td>Shirley Beck</td>
<td>14</td>
<td>32</td>
<td>Beck</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>92522</td>
<td>Christina Kelly</td>
<td>8</td>
<td>44</td>
<td>Kelly</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>22447</td>
<td>Brian Noble</td>
<td>11</td>
<td>39</td>
<td>Noble</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>61654</td>
<td>Randy Key</td>
<td>16</td>
<td>38</td>
<td>Key</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>16988</td>
<td>Diana Stewart</td>
<td>14</td>
<td>48</td>
<td>Stewart</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>68619</td>
<td>Timothy Sosa</td>
<td>14</td>
<td>42</td>
<td>Sosa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>59949</td>
<td>Betty Skinner</td>
<td>11</td>
<td>48</td>
<td>Skinner</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>81418</td>
<td>Janet Maxwell</td>
<td>12</td>
<td>38</td>
<td>Maxwell</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>27267</td>
<td>Madison Johnston</td>
<td>20</td>
<td>37</td>
<td>Johnston</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>19985</td>
<td>Virginia Nichols</td>
<td>13</td>
<td>49</td>
<td>Nichols</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="applying-a-lambda-to-a-row" class="level3">
<h3 class="anchored" data-anchor-id="applying-a-lambda-to-a-row">Applying a Lambda to a Row</h3>
<p>We can also operate on multiple columns at once. If we use apply without specifying a single column and add the argument <code>axis=1</code>, the input to our lambda function will be an entire <code>row</code>, not a column. To access particular values of the row, we use the syntax <code>row.column_name</code> or <code>row[‘column_name’]</code>.</p>
<p>Suppose we have a table representing a grocery list. If we want to add in the price with tax for each line, we’ll need to look at two columns: Price and Is taxed?.</p>
<p>If Is taxed? is Yes, then we’ll want to multiply Price by 1.075 (for 7.5% sales tax).</p>
<p>If Is taxed? is No, we’ll just have Price without multiplying it.</p>
<p>We can create this column using a lambda function and the keyword axis=1:</p>
<pre><code>df['Price with Tax'] = df.apply(lambda row:
 row['Price'] * 1.075
 if row['Is taxed?'] == 'Yes'
 else row['Price'],
 axis=1
)</code></pre>
<blockquote class="blockquote">
<p>Q. If an employee worked for more than 40 hours, she needs to be paid overtime (1.5 times the normal hourly wage). For instance, if an employee worked for 43 hours and made 10/hour, she would receive 400 for the first 40 hours that she worked, and an additional 45 for the 3 hours of overtime, for a total for 445. Create a lambda function <code>total_earned</code> that accepts an input row with keys <code>hours_worked</code> and <code>hourly_wage</code> and uses an if statement to calculate the total wages earned.</p>
</blockquote>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>total_earned <span class="op">=</span> <span class="kw">lambda</span> row: row[<span class="st">'hours_worked'</span>] <span class="op">*</span> row[<span class="st">'hourly_wage'</span>] <span class="cf">if</span> row[<span class="st">'hours_worked'</span>] <span class="op">&lt;=</span> <span class="dv">40</span> <span class="cf">else</span> (<span class="dv">40</span> <span class="op">*</span> row[<span class="st">'hourly_wage'</span>]) <span class="op">+</span> ((row[<span class="st">'hours_worked'</span>] <span class="op">-</span> <span class="dv">40</span>) <span class="op">*</span> <span class="fl">1.5</span> <span class="op">*</span> row[<span class="st">'hourly_wage'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Q. Use the lambda function <code>total_earned</code> and apply to add a column <code>total_earned</code> to df with the total amount earned by each employee.</p>
</blockquote>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'total_earned'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(total_earned, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">hourly_wage</th>
<th data-quarto-table-cell-role="th">hours_worked</th>
<th data-quarto-table-cell-role="th">last_name</th>
<th data-quarto-table-cell-role="th">total_earned</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10310</td>
<td>Lauren Durham</td>
<td>19</td>
<td>43</td>
<td>Durham</td>
<td>845.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>18656</td>
<td>Grace Sellers</td>
<td>17</td>
<td>40</td>
<td>Sellers</td>
<td>680.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>61254</td>
<td>Shirley Rasmussen</td>
<td>16</td>
<td>30</td>
<td>Rasmussen</td>
<td>480.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>16886</td>
<td>Brian Rojas</td>
<td>18</td>
<td>47</td>
<td>Rojas</td>
<td>909.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>89010</td>
<td>Samantha Mosley</td>
<td>11</td>
<td>38</td>
<td>Mosley</td>
<td>418.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>87246</td>
<td>Louis Guzman</td>
<td>14</td>
<td>39</td>
<td>Guzman</td>
<td>546.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>20578</td>
<td>Denise Mcclure</td>
<td>15</td>
<td>40</td>
<td>Mcclure</td>
<td>600.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>12869</td>
<td>James Raymond</td>
<td>15</td>
<td>32</td>
<td>Raymond</td>
<td>480.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>53461</td>
<td>Noah Collier</td>
<td>18</td>
<td>35</td>
<td>Collier</td>
<td>630.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>14746</td>
<td>Donna Frederick</td>
<td>20</td>
<td>41</td>
<td>Frederick</td>
<td>830.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>71127</td>
<td>Shirley Beck</td>
<td>14</td>
<td>32</td>
<td>Beck</td>
<td>448.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>92522</td>
<td>Christina Kelly</td>
<td>8</td>
<td>44</td>
<td>Kelly</td>
<td>368.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>22447</td>
<td>Brian Noble</td>
<td>11</td>
<td>39</td>
<td>Noble</td>
<td>429.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>61654</td>
<td>Randy Key</td>
<td>16</td>
<td>38</td>
<td>Key</td>
<td>608.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>16988</td>
<td>Diana Stewart</td>
<td>14</td>
<td>48</td>
<td>Stewart</td>
<td>728.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>68619</td>
<td>Timothy Sosa</td>
<td>14</td>
<td>42</td>
<td>Sosa</td>
<td>602.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>59949</td>
<td>Betty Skinner</td>
<td>11</td>
<td>48</td>
<td>Skinner</td>
<td>572.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>81418</td>
<td>Janet Maxwell</td>
<td>12</td>
<td>38</td>
<td>Maxwell</td>
<td>456.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>27267</td>
<td>Madison Johnston</td>
<td>20</td>
<td>37</td>
<td>Johnston</td>
<td>740.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>19985</td>
<td>Virginia Nichols</td>
<td>13</td>
<td>49</td>
<td>Nichols</td>
<td>695.5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="renaming-columns" class="level3">
<h3 class="anchored" data-anchor-id="renaming-columns">Renaming Columns</h3>
<p>When we get our data from other sources, we often want to change the column names. For example, we might want all of the column names to follow variable name rules, so that we can use <code>df.column_name</code> (which tab-completes) rather than df[‘column_name’] (which takes up extra space).</p>
<p>You can change all of the column names at once by setting the <code>.columns</code> property to a different list. This is great when you need to change all of the column names at once, but be careful! You can easily mislabel columns if you get the ordering wrong.</p>
<p>Here’s an example:</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: [<span class="st">'John'</span>, <span class="st">'Jane'</span>, <span class="st">'Sue'</span>, <span class="st">'Fred'</span>],</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'age'</span>: [<span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">21</span>, <span class="dv">18</span>]</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>df.columns <span class="op">=</span> [<span class="st">'First Name'</span>, <span class="st">'Age'</span>]</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">First Name</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>John</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jane</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Sue</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Fred</td>
<td>18</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. The DataFrame df contains data about movies from IMDb.We want to present this data to some film producers. Right now, our column names are in lower case, and are not very descriptive. Let’s modify df using the <code>.columns</code> attribute to make the following changes to the columns:</p>
</blockquote>
<pre><code>Old New
id  ID
name    Title
genre   Category
year    Year Released
imdb_rating Rating</code></pre>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/imdb.csv'</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">genre</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Avatar</td>
<td>action</td>
<td>2009</td>
<td>7.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Jurassic World</td>
<td>action</td>
<td>2015</td>
<td>7.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>The Avengers</td>
<td>action</td>
<td>2012</td>
<td>8.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>The Dark Knight</td>
<td>action</td>
<td>2008</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Star Wars: Episode I - The Phantom Menace</td>
<td>action</td>
<td>1999</td>
<td>6.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">215</td>
<td>216</td>
<td>Hannibal</td>
<td>drama</td>
<td>2001</td>
<td>6.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">216</td>
<td>217</td>
<td>Catch Me If You Can</td>
<td>drama</td>
<td>2002</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">217</td>
<td>218</td>
<td>Big Daddy</td>
<td>drama</td>
<td>1999</td>
<td>6.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">218</td>
<td>219</td>
<td>Se7en</td>
<td>drama</td>
<td>1995</td>
<td>8.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">219</td>
<td>220</td>
<td>Seven</td>
<td>drama</td>
<td>1979</td>
<td>6.1</td>
</tr>
</tbody>
</table>

<p>220 rows × 5 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>df.columns <span class="op">=</span> [<span class="st">'ID'</span>, <span class="st">'Title'</span>, <span class="st">'Category'</span>,<span class="st">'Year Released'</span>, <span class="st">'Rating'</span>]</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">Title</th>
<th data-quarto-table-cell-role="th">Category</th>
<th data-quarto-table-cell-role="th">Year Released</th>
<th data-quarto-table-cell-role="th">Rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Avatar</td>
<td>action</td>
<td>2009</td>
<td>7.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Jurassic World</td>
<td>action</td>
<td>2015</td>
<td>7.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>The Avengers</td>
<td>action</td>
<td>2012</td>
<td>8.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>The Dark Knight</td>
<td>action</td>
<td>2008</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Star Wars: Episode I - The Phantom Menace</td>
<td>action</td>
<td>1999</td>
<td>6.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">215</td>
<td>216</td>
<td>Hannibal</td>
<td>drama</td>
<td>2001</td>
<td>6.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">216</td>
<td>217</td>
<td>Catch Me If You Can</td>
<td>drama</td>
<td>2002</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">217</td>
<td>218</td>
<td>Big Daddy</td>
<td>drama</td>
<td>1999</td>
<td>6.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">218</td>
<td>219</td>
<td>Se7en</td>
<td>drama</td>
<td>1995</td>
<td>8.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">219</td>
<td>220</td>
<td>Seven</td>
<td>drama</td>
<td>1979</td>
<td>6.1</td>
</tr>
</tbody>
</table>

<p>220 rows × 5 columns</p>
</div>
</div>
</div>
</section>
<section id="renaming-columns-ii" class="level3">
<h3 class="anchored" data-anchor-id="renaming-columns-ii">Renaming Columns II</h3>
<p>You also can rename individual columns by using the <code>.rename</code> method. Pass a dictionary like the one below to the columns keyword argument:</p>
<pre><code>{'old_column_name1': 
'new_column_name1',
'old_column_name2':
'new_column_name2'}</code></pre>
<p>Here’s an example:</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: [<span class="st">'John'</span>, <span class="st">'Jane'</span>, <span class="st">'Sue'</span>, <span class="st">'Fred'</span>],</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'age'</span>: [<span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">21</span>, <span class="dv">18</span>]</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>John</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jane</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Sue</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Fred</td>
<td>18</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: <span class="st">'First Name'</span>,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'age'</span>: <span class="st">'Age'</span>},</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">First Name</th>
<th data-quarto-table-cell-role="th">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>John</td>
<td>23</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Jane</td>
<td>29</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Sue</td>
<td>21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Fred</td>
<td>18</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Using rename with only the columns keyword will create a new DataFrame, leaving your original DataFrame unchanged. That’s why we also passed in the keyword argument <code>inplace=True</code>. Using inplace=True lets us edit the original DataFrame.</p>
<p>There are several reasons why <code>.rename</code> is preferable to <code>.columns</code>:</p>
<ul>
<li>You can rename just one column</li>
<li>You can be specific about which column names are getting changed (with .column you can accidentally switch column names if you’re not careful)</li>
</ul>
<blockquote class="blockquote">
<p>Note: If you misspell one of the original column names, this command won’t fail. It just won’t change anything.</p>
</blockquote>
<blockquote class="blockquote">
<p>Q. If we didn’t know that df was a table of movie ratings, the column name might be confusing.To clarify, let’s rename name to movie_title. Use the keyword inplace=True so that you modify df rather than creating a new DataFrame!</p>
</blockquote>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/imdb.csv'</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">genre</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Avatar</td>
<td>action</td>
<td>2009</td>
<td>7.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Jurassic World</td>
<td>action</td>
<td>2015</td>
<td>7.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>The Avengers</td>
<td>action</td>
<td>2012</td>
<td>8.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>The Dark Knight</td>
<td>action</td>
<td>2008</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Star Wars: Episode I - The Phantom Menace</td>
<td>action</td>
<td>1999</td>
<td>6.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">215</td>
<td>216</td>
<td>Hannibal</td>
<td>drama</td>
<td>2001</td>
<td>6.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">216</td>
<td>217</td>
<td>Catch Me If You Can</td>
<td>drama</td>
<td>2002</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">217</td>
<td>218</td>
<td>Big Daddy</td>
<td>drama</td>
<td>1999</td>
<td>6.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">218</td>
<td>219</td>
<td>Se7en</td>
<td>drama</td>
<td>1995</td>
<td>8.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">219</td>
<td>220</td>
<td>Seven</td>
<td>drama</td>
<td>1979</td>
<td>6.1</td>
</tr>
</tbody>
</table>

<p>220 rows × 5 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: <span class="st">'movie_title'</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">movie_title</th>
<th data-quarto-table-cell-role="th">genre</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">imdb_rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Avatar</td>
<td>action</td>
<td>2009</td>
<td>7.9</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Jurassic World</td>
<td>action</td>
<td>2015</td>
<td>7.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>The Avengers</td>
<td>action</td>
<td>2012</td>
<td>8.1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>The Dark Knight</td>
<td>action</td>
<td>2008</td>
<td>9.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Star Wars: Episode I - The Phantom Menace</td>
<td>action</td>
<td>1999</td>
<td>6.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">215</td>
<td>216</td>
<td>Hannibal</td>
<td>drama</td>
<td>2001</td>
<td>6.7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">216</td>
<td>217</td>
<td>Catch Me If You Can</td>
<td>drama</td>
<td>2002</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">217</td>
<td>218</td>
<td>Big Daddy</td>
<td>drama</td>
<td>1999</td>
<td>6.4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">218</td>
<td>219</td>
<td>Se7en</td>
<td>drama</td>
<td>1995</td>
<td>8.6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">219</td>
<td>220</td>
<td>Seven</td>
<td>drama</td>
<td>1979</td>
<td>6.1</td>
</tr>
</tbody>
</table>

<p>220 rows × 5 columns</p>
</div>
</div>
</div>
</section>
<section id="bringing-it-all-together-1" class="level3">
<h3 class="anchored" data-anchor-id="bringing-it-all-together-1">Bringing it all together</h3>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>orders <span class="op">=</span> pd.read_csv(<span class="st">'data/shoefly_gender.csv'</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>orders.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">last_name</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_material</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>54791</td>
<td>Rebecca</td>
<td>Lindsay</td>
<td>female</td>
<td>RebeccaLindsay57@hotmail.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>black</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>53450</td>
<td>Emily</td>
<td>Joyce</td>
<td>female</td>
<td>EmilyJoyce25@gmail.com</td>
<td>ballet flats</td>
<td>faux-leather</td>
<td>navy</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>91987</td>
<td>Joyce</td>
<td>Waller</td>
<td>female</td>
<td>Joyce.Waller@gmail.com</td>
<td>sandles</td>
<td>fabric</td>
<td>black</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>14437</td>
<td>Justin</td>
<td>Erickson</td>
<td>male</td>
<td>Justin.Erickson@outlook.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>red</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>79357</td>
<td>Andrew</td>
<td>Banks</td>
<td>male</td>
<td>AB4318@gmail.com</td>
<td>boots</td>
<td>leather</td>
<td>brown</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Many of our customers want to buy vegan shoes (shoes made from materials that do not come from animals). Add a new column called <code>shoe_source</code>, which is vegan if the materials is not leather and animal otherwise.</p>
</blockquote>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>shoe_source <span class="op">=</span> <span class="kw">lambda</span> df: <span class="st">"vegan"</span> <span class="cf">if</span> df[<span class="st">'shoe_material'</span>] <span class="op">!=</span> <span class="st">'leather'</span> <span class="cf">else</span> <span class="st">"animal"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>orders[<span class="st">'shoe_source'</span>] <span class="op">=</span> orders.<span class="bu">apply</span>(shoe_source, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>orders.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">last_name</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_material</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
<th data-quarto-table-cell-role="th">shoe_source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>54791</td>
<td>Rebecca</td>
<td>Lindsay</td>
<td>female</td>
<td>RebeccaLindsay57@hotmail.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>black</td>
<td>vegan</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>53450</td>
<td>Emily</td>
<td>Joyce</td>
<td>female</td>
<td>EmilyJoyce25@gmail.com</td>
<td>ballet flats</td>
<td>faux-leather</td>
<td>navy</td>
<td>vegan</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>91987</td>
<td>Joyce</td>
<td>Waller</td>
<td>female</td>
<td>Joyce.Waller@gmail.com</td>
<td>sandles</td>
<td>fabric</td>
<td>black</td>
<td>vegan</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>14437</td>
<td>Justin</td>
<td>Erickson</td>
<td>male</td>
<td>Justin.Erickson@outlook.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>red</td>
<td>vegan</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>79357</td>
<td>Andrew</td>
<td>Banks</td>
<td>male</td>
<td>AB4318@gmail.com</td>
<td>boots</td>
<td>leather</td>
<td>brown</td>
<td>animal</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Our marketing department wants to send out an email to each customer. Using the columns last_name and gender create a column called salutation which contains <code>Dear Mr. &lt;last_name&gt;</code> for men and <code>Dear Ms. &lt;last_name&gt;</code> for women.</p>
</blockquote>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>salutation <span class="op">=</span> <span class="kw">lambda</span> row: <span class="st">"Dear Mr."</span> <span class="op">+</span> row[<span class="st">'last_name'</span>] <span class="cf">if</span> row[<span class="st">'gender'</span>] <span class="op">==</span> <span class="st">'male'</span> <span class="cf">else</span> <span class="st">"Dear Ms."</span> <span class="op">+</span> row[<span class="st">'last_name'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>orders[<span class="st">'salutation'</span>] <span class="op">=</span> orders.<span class="bu">apply</span>(salutation, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>orders.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">last_name</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_material</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
<th data-quarto-table-cell-role="th">shoe_source</th>
<th data-quarto-table-cell-role="th">salutation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>54791</td>
<td>Rebecca</td>
<td>Lindsay</td>
<td>female</td>
<td>RebeccaLindsay57@hotmail.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>black</td>
<td>vegan</td>
<td>Dear Ms.Lindsay</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>53450</td>
<td>Emily</td>
<td>Joyce</td>
<td>female</td>
<td>EmilyJoyce25@gmail.com</td>
<td>ballet flats</td>
<td>faux-leather</td>
<td>navy</td>
<td>vegan</td>
<td>Dear Ms.Joyce</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>91987</td>
<td>Joyce</td>
<td>Waller</td>
<td>female</td>
<td>Joyce.Waller@gmail.com</td>
<td>sandles</td>
<td>fabric</td>
<td>black</td>
<td>vegan</td>
<td>Dear Ms.Waller</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>14437</td>
<td>Justin</td>
<td>Erickson</td>
<td>male</td>
<td>Justin.Erickson@outlook.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>red</td>
<td>vegan</td>
<td>Dear Mr.Erickson</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>79357</td>
<td>Andrew</td>
<td>Banks</td>
<td>male</td>
<td>AB4318@gmail.com</td>
<td>boots</td>
<td>leather</td>
<td>brown</td>
<td>animal</td>
<td>Dear Mr.Banks</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>orders[<span class="st">'salutation'</span>] <span class="op">=</span> orders.<span class="bu">apply</span>(<span class="kw">lambda</span> row: <span class="st">"Dear Mr. "</span> <span class="op">+</span> row[<span class="st">'last_name'</span>] <span class="cf">if</span> row[<span class="st">'gender'</span>] <span class="op">==</span> <span class="st">'male'</span> <span class="cf">else</span> <span class="st">"Dear Ms. "</span> <span class="op">+</span> row[<span class="st">'last_name'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>orders.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">last_name</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_material</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
<th data-quarto-table-cell-role="th">shoe_source</th>
<th data-quarto-table-cell-role="th">salutation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>54791</td>
<td>Rebecca</td>
<td>Lindsay</td>
<td>female</td>
<td>RebeccaLindsay57@hotmail.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>black</td>
<td>vegan</td>
<td>Dear Ms. Lindsay</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>53450</td>
<td>Emily</td>
<td>Joyce</td>
<td>female</td>
<td>EmilyJoyce25@gmail.com</td>
<td>ballet flats</td>
<td>faux-leather</td>
<td>navy</td>
<td>vegan</td>
<td>Dear Ms. Joyce</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>91987</td>
<td>Joyce</td>
<td>Waller</td>
<td>female</td>
<td>Joyce.Waller@gmail.com</td>
<td>sandles</td>
<td>fabric</td>
<td>black</td>
<td>vegan</td>
<td>Dear Ms. Waller</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>14437</td>
<td>Justin</td>
<td>Erickson</td>
<td>male</td>
<td>Justin.Erickson@outlook.com</td>
<td>clogs</td>
<td>faux-leather</td>
<td>red</td>
<td>vegan</td>
<td>Dear Mr. Erickson</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>79357</td>
<td>Andrew</td>
<td>Banks</td>
<td>male</td>
<td>AB4318@gmail.com</td>
<td>boots</td>
<td>leather</td>
<td>brown</td>
<td>animal</td>
<td>Dear Mr. Banks</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="project---petal-power-inventory" class="level3">
<h3 class="anchored" data-anchor-id="project---petal-power-inventory">Project - Petal Power Inventory</h3>
<p>You’re the lead data analyst for a chain of gardening stores called Petal Power. Help them analyze their inventory!</p>
<blockquote class="blockquote">
<p>Q1. Data for all of the locations of Petal Power is in the file inventory.csv. Load the data into a DataFrame called inventory. Inspect the first 10 rows of inventory</p>
</blockquote>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>inventory <span class="op">=</span> pd.read_csv(<span class="st">'data/inventory.csv'</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>inventory.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">product_type</th>
<th data-quarto-table-cell-role="th">product_description</th>
<th data-quarto-table-cell-role="th">quantity</th>
<th data-quarto-table-cell-role="th">price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Staten Island</td>
<td>seeds</td>
<td>daisy</td>
<td>4</td>
<td>6.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Staten Island</td>
<td>seeds</td>
<td>calla lily</td>
<td>46</td>
<td>19.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Staten Island</td>
<td>seeds</td>
<td>tomato</td>
<td>85</td>
<td>13.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>rake</td>
<td>4</td>
<td>13.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>0</td>
<td>89.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>spade</td>
<td>93</td>
<td>19.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Staten Island</td>
<td>pest_control</td>
<td>insect killer</td>
<td>74</td>
<td>12.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Staten Island</td>
<td>pest_control</td>
<td>weed killer</td>
<td>8</td>
<td>23.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Staten Island</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>0</td>
<td>17.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Staten Island</td>
<td>planter</td>
<td>8 inch plastic planter</td>
<td>53</td>
<td>3.99</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. The first 10 rows represent data from your Staten Island location. Select these rows and save them to staten_island.</p>
</blockquote>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>staten_island <span class="op">=</span> inventory[:<span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">product_type</th>
<th data-quarto-table-cell-role="th">product_description</th>
<th data-quarto-table-cell-role="th">quantity</th>
<th data-quarto-table-cell-role="th">price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Staten Island</td>
<td>seeds</td>
<td>daisy</td>
<td>4</td>
<td>6.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Staten Island</td>
<td>seeds</td>
<td>calla lily</td>
<td>46</td>
<td>19.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Staten Island</td>
<td>seeds</td>
<td>tomato</td>
<td>85</td>
<td>13.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>rake</td>
<td>4</td>
<td>13.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>0</td>
<td>89.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>spade</td>
<td>93</td>
<td>19.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Staten Island</td>
<td>pest_control</td>
<td>insect killer</td>
<td>74</td>
<td>12.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Staten Island</td>
<td>pest_control</td>
<td>weed killer</td>
<td>8</td>
<td>23.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Staten Island</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>0</td>
<td>17.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Staten Island</td>
<td>planter</td>
<td>8 inch plastic planter</td>
<td>53</td>
<td>3.99</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. A customer just emailed you asking what products are sold at your Staten Island location. Select the column product_description from staten_island and save it to the variable product_request.</p>
</blockquote>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>product_request <span class="op">=</span> inventory.product_description</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>product_request</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>0                          daisy
1                     calla lily
2                         tomato
3                           rake
4                    wheelbarrow
5                          spade
6                  insect killer
7                    weed killer
8     20 inch terracotta planter
9         8 inch plastic planter
10                         daisy
11                    calla lily
12                        tomato
13                          rake
14                   wheelbarrow
15                         spade
16                 insect killer
17                   weed killer
18    20 inch terracotta planter
19        8 inch plastic planter
20                         daisy
21                    calla lily
22                        tomato
23                          rake
24                   wheelbarrow
25                         spade
26                 insect killer
27                   weed killer
28    20 inch terracotta planter
Name: product_description, dtype: object</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Another customer emails to ask what types of seeds are sold at the Brooklyn location.Select all rows where location is equal to Brooklyn and product_type is equal to seeds and save them to the variable seed_request.</p>
</blockquote>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>seed_request <span class="op">=</span> inventory[(inventory.location <span class="op">==</span> <span class="st">'Brooklyn'</span>) <span class="op">&amp;</span> (inventory.product_type <span class="op">==</span> <span class="st">'seeds'</span>)]</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>seed_request</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">product_type</th>
<th data-quarto-table-cell-role="th">product_description</th>
<th data-quarto-table-cell-role="th">quantity</th>
<th data-quarto-table-cell-role="th">price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>daisy</td>
<td>50</td>
<td>6.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>calla lily</td>
<td>0</td>
<td>19.99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>tomato</td>
<td>0</td>
<td>13.99</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Add a column to inventory called <code>in_stock</code> which is True if quantity is greater than 0 and False if quantity equals 0.</p>
</blockquote>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>in_stock <span class="op">=</span> <span class="kw">lambda</span> row: <span class="st">"True"</span> <span class="cf">if</span> row[<span class="st">'quantity'</span>] <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">"False"</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>inventory[<span class="st">'in_stock'</span>] <span class="op">=</span> inventory.<span class="bu">apply</span>(in_stock, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>inventory</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">product_type</th>
<th data-quarto-table-cell-role="th">product_description</th>
<th data-quarto-table-cell-role="th">quantity</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">in_stock</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Staten Island</td>
<td>seeds</td>
<td>daisy</td>
<td>4</td>
<td>6.99</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Staten Island</td>
<td>seeds</td>
<td>calla lily</td>
<td>46</td>
<td>19.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Staten Island</td>
<td>seeds</td>
<td>tomato</td>
<td>85</td>
<td>13.99</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>rake</td>
<td>4</td>
<td>13.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>0</td>
<td>89.99</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>spade</td>
<td>93</td>
<td>19.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Staten Island</td>
<td>pest_control</td>
<td>insect killer</td>
<td>74</td>
<td>12.99</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Staten Island</td>
<td>pest_control</td>
<td>weed killer</td>
<td>8</td>
<td>23.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Staten Island</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>0</td>
<td>17.99</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Staten Island</td>
<td>planter</td>
<td>8 inch plastic planter</td>
<td>53</td>
<td>3.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>daisy</td>
<td>50</td>
<td>6.99</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>calla lily</td>
<td>0</td>
<td>19.99</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>tomato</td>
<td>0</td>
<td>13.99</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Brooklyn</td>
<td>garden tools</td>
<td>rake</td>
<td>15</td>
<td>13.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Brooklyn</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>82</td>
<td>89.99</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Brooklyn</td>
<td>garden tools</td>
<td>spade</td>
<td>36</td>
<td>19.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Brooklyn</td>
<td>pest_control</td>
<td>insect killer</td>
<td>80</td>
<td>12.99</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Brooklyn</td>
<td>pest_control</td>
<td>weed killer</td>
<td>76</td>
<td>23.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Brooklyn</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>5</td>
<td>17.99</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Brooklyn</td>
<td>planter</td>
<td>8 inch plastic planter</td>
<td>26</td>
<td>3.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>Queens</td>
<td>seeds</td>
<td>daisy</td>
<td>57</td>
<td>6.99</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Queens</td>
<td>seeds</td>
<td>calla lily</td>
<td>95</td>
<td>19.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Queens</td>
<td>seeds</td>
<td>tomato</td>
<td>45</td>
<td>13.99</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Queens</td>
<td>garden tools</td>
<td>rake</td>
<td>21</td>
<td>13.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>Queens</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>98</td>
<td>89.99</td>
<td>True</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Queens</td>
<td>garden tools</td>
<td>spade</td>
<td>26</td>
<td>19.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Queens</td>
<td>pest_control</td>
<td>insect killer</td>
<td>0</td>
<td>12.99</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>Queens</td>
<td>pest_control</td>
<td>weed killer</td>
<td>16</td>
<td>23.99</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>Queens</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>87</td>
<td>17.99</td>
<td>True</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Petal Power wants to know how valuable their current inventory is. Create a column called total_value that is equal to price multiplied by quantity.</p>
</blockquote>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>inventory[<span class="st">'total_value'</span>] <span class="op">=</span> inventory.quantity <span class="op">*</span> inventory.price</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>inventory</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">product_type</th>
<th data-quarto-table-cell-role="th">product_description</th>
<th data-quarto-table-cell-role="th">quantity</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">in_stock</th>
<th data-quarto-table-cell-role="th">total_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Staten Island</td>
<td>seeds</td>
<td>daisy</td>
<td>4</td>
<td>6.99</td>
<td>True</td>
<td>27.96</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Staten Island</td>
<td>seeds</td>
<td>calla lily</td>
<td>46</td>
<td>19.99</td>
<td>True</td>
<td>919.54</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Staten Island</td>
<td>seeds</td>
<td>tomato</td>
<td>85</td>
<td>13.99</td>
<td>True</td>
<td>1189.15</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>rake</td>
<td>4</td>
<td>13.99</td>
<td>True</td>
<td>55.96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>0</td>
<td>89.99</td>
<td>False</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>spade</td>
<td>93</td>
<td>19.99</td>
<td>True</td>
<td>1859.07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Staten Island</td>
<td>pest_control</td>
<td>insect killer</td>
<td>74</td>
<td>12.99</td>
<td>True</td>
<td>961.26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Staten Island</td>
<td>pest_control</td>
<td>weed killer</td>
<td>8</td>
<td>23.99</td>
<td>True</td>
<td>191.92</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Staten Island</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>0</td>
<td>17.99</td>
<td>False</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Staten Island</td>
<td>planter</td>
<td>8 inch plastic planter</td>
<td>53</td>
<td>3.99</td>
<td>True</td>
<td>211.47</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>daisy</td>
<td>50</td>
<td>6.99</td>
<td>True</td>
<td>349.50</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>calla lily</td>
<td>0</td>
<td>19.99</td>
<td>False</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>tomato</td>
<td>0</td>
<td>13.99</td>
<td>False</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Brooklyn</td>
<td>garden tools</td>
<td>rake</td>
<td>15</td>
<td>13.99</td>
<td>True</td>
<td>209.85</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Brooklyn</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>82</td>
<td>89.99</td>
<td>True</td>
<td>7379.18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Brooklyn</td>
<td>garden tools</td>
<td>spade</td>
<td>36</td>
<td>19.99</td>
<td>True</td>
<td>719.64</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Brooklyn</td>
<td>pest_control</td>
<td>insect killer</td>
<td>80</td>
<td>12.99</td>
<td>True</td>
<td>1039.20</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Brooklyn</td>
<td>pest_control</td>
<td>weed killer</td>
<td>76</td>
<td>23.99</td>
<td>True</td>
<td>1823.24</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Brooklyn</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>5</td>
<td>17.99</td>
<td>True</td>
<td>89.95</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Brooklyn</td>
<td>planter</td>
<td>8 inch plastic planter</td>
<td>26</td>
<td>3.99</td>
<td>True</td>
<td>103.74</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>Queens</td>
<td>seeds</td>
<td>daisy</td>
<td>57</td>
<td>6.99</td>
<td>True</td>
<td>398.43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Queens</td>
<td>seeds</td>
<td>calla lily</td>
<td>95</td>
<td>19.99</td>
<td>True</td>
<td>1899.05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Queens</td>
<td>seeds</td>
<td>tomato</td>
<td>45</td>
<td>13.99</td>
<td>True</td>
<td>629.55</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Queens</td>
<td>garden tools</td>
<td>rake</td>
<td>21</td>
<td>13.99</td>
<td>True</td>
<td>293.79</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>Queens</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>98</td>
<td>89.99</td>
<td>True</td>
<td>8819.02</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Queens</td>
<td>garden tools</td>
<td>spade</td>
<td>26</td>
<td>19.99</td>
<td>True</td>
<td>519.74</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Queens</td>
<td>pest_control</td>
<td>insect killer</td>
<td>0</td>
<td>12.99</td>
<td>False</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>Queens</td>
<td>pest_control</td>
<td>weed killer</td>
<td>16</td>
<td>23.99</td>
<td>True</td>
<td>383.84</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>Queens</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>87</td>
<td>17.99</td>
<td>True</td>
<td>1565.13</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. The Marketing department wants a complete description of each product for their catalog.The following lambda function combines product_type and product_description into a single string:</p>
</blockquote>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>combine_lambda <span class="op">=</span> <span class="kw">lambda</span> row: <span class="st">'</span><span class="sc">{}</span><span class="st"> - </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(row.product_type, row.product_description)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Q.Using combine_lambda, create a new column in inventory called full_description that has the complete description of each product.</p>
</blockquote>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>inventory[<span class="st">'full_description'</span>] <span class="op">=</span> inventory.<span class="bu">apply</span>(combine_lambda, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>inventory</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">product_type</th>
<th data-quarto-table-cell-role="th">product_description</th>
<th data-quarto-table-cell-role="th">quantity</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">in_stock</th>
<th data-quarto-table-cell-role="th">total_value</th>
<th data-quarto-table-cell-role="th">full_description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Staten Island</td>
<td>seeds</td>
<td>daisy</td>
<td>4</td>
<td>6.99</td>
<td>True</td>
<td>27.96</td>
<td>seeds - daisy</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Staten Island</td>
<td>seeds</td>
<td>calla lily</td>
<td>46</td>
<td>19.99</td>
<td>True</td>
<td>919.54</td>
<td>seeds - calla lily</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Staten Island</td>
<td>seeds</td>
<td>tomato</td>
<td>85</td>
<td>13.99</td>
<td>True</td>
<td>1189.15</td>
<td>seeds - tomato</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>rake</td>
<td>4</td>
<td>13.99</td>
<td>True</td>
<td>55.96</td>
<td>garden tools - rake</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>0</td>
<td>89.99</td>
<td>False</td>
<td>0.00</td>
<td>garden tools - wheelbarrow</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Staten Island</td>
<td>garden tools</td>
<td>spade</td>
<td>93</td>
<td>19.99</td>
<td>True</td>
<td>1859.07</td>
<td>garden tools - spade</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Staten Island</td>
<td>pest_control</td>
<td>insect killer</td>
<td>74</td>
<td>12.99</td>
<td>True</td>
<td>961.26</td>
<td>pest_control - insect killer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Staten Island</td>
<td>pest_control</td>
<td>weed killer</td>
<td>8</td>
<td>23.99</td>
<td>True</td>
<td>191.92</td>
<td>pest_control - weed killer</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Staten Island</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>0</td>
<td>17.99</td>
<td>False</td>
<td>0.00</td>
<td>planter - 20 inch terracotta planter</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Staten Island</td>
<td>planter</td>
<td>8 inch plastic planter</td>
<td>53</td>
<td>3.99</td>
<td>True</td>
<td>211.47</td>
<td>planter - 8 inch plastic planter</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>daisy</td>
<td>50</td>
<td>6.99</td>
<td>True</td>
<td>349.50</td>
<td>seeds - daisy</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>calla lily</td>
<td>0</td>
<td>19.99</td>
<td>False</td>
<td>0.00</td>
<td>seeds - calla lily</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Brooklyn</td>
<td>seeds</td>
<td>tomato</td>
<td>0</td>
<td>13.99</td>
<td>False</td>
<td>0.00</td>
<td>seeds - tomato</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Brooklyn</td>
<td>garden tools</td>
<td>rake</td>
<td>15</td>
<td>13.99</td>
<td>True</td>
<td>209.85</td>
<td>garden tools - rake</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Brooklyn</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>82</td>
<td>89.99</td>
<td>True</td>
<td>7379.18</td>
<td>garden tools - wheelbarrow</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Brooklyn</td>
<td>garden tools</td>
<td>spade</td>
<td>36</td>
<td>19.99</td>
<td>True</td>
<td>719.64</td>
<td>garden tools - spade</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Brooklyn</td>
<td>pest_control</td>
<td>insect killer</td>
<td>80</td>
<td>12.99</td>
<td>True</td>
<td>1039.20</td>
<td>pest_control - insect killer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Brooklyn</td>
<td>pest_control</td>
<td>weed killer</td>
<td>76</td>
<td>23.99</td>
<td>True</td>
<td>1823.24</td>
<td>pest_control - weed killer</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Brooklyn</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>5</td>
<td>17.99</td>
<td>True</td>
<td>89.95</td>
<td>planter - 20 inch terracotta planter</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Brooklyn</td>
<td>planter</td>
<td>8 inch plastic planter</td>
<td>26</td>
<td>3.99</td>
<td>True</td>
<td>103.74</td>
<td>planter - 8 inch plastic planter</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>Queens</td>
<td>seeds</td>
<td>daisy</td>
<td>57</td>
<td>6.99</td>
<td>True</td>
<td>398.43</td>
<td>seeds - daisy</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>Queens</td>
<td>seeds</td>
<td>calla lily</td>
<td>95</td>
<td>19.99</td>
<td>True</td>
<td>1899.05</td>
<td>seeds - calla lily</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Queens</td>
<td>seeds</td>
<td>tomato</td>
<td>45</td>
<td>13.99</td>
<td>True</td>
<td>629.55</td>
<td>seeds - tomato</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Queens</td>
<td>garden tools</td>
<td>rake</td>
<td>21</td>
<td>13.99</td>
<td>True</td>
<td>293.79</td>
<td>garden tools - rake</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>Queens</td>
<td>garden tools</td>
<td>wheelbarrow</td>
<td>98</td>
<td>89.99</td>
<td>True</td>
<td>8819.02</td>
<td>garden tools - wheelbarrow</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>Queens</td>
<td>garden tools</td>
<td>spade</td>
<td>26</td>
<td>19.99</td>
<td>True</td>
<td>519.74</td>
<td>garden tools - spade</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>Queens</td>
<td>pest_control</td>
<td>insect killer</td>
<td>0</td>
<td>12.99</td>
<td>False</td>
<td>0.00</td>
<td>pest_control - insect killer</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>Queens</td>
<td>pest_control</td>
<td>weed killer</td>
<td>16</td>
<td>23.99</td>
<td>True</td>
<td>383.84</td>
<td>pest_control - weed killer</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>Queens</td>
<td>planter</td>
<td>20 inch terracotta planter</td>
<td>87</td>
<td>17.99</td>
<td>True</td>
<td>1565.13</td>
<td>planter - 20 inch terracotta planter</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="aggregates-in-pandas" class="level3">
<h3 class="anchored" data-anchor-id="aggregates-in-pandas">Aggregates in Pandas</h3>
<p>An aggregate statistic is a way of creating a single number that describes a group of numbers. Common aggregate statistics include mean, median, and standard deviation.</p>
<p>You will also learn how to rearrange a DataFrame into a pivot table, which is a great way to compare data across two dimensions.</p>
</section>
<section id="calculating-column-statistics" class="level3">
<h3 class="anchored" data-anchor-id="calculating-column-statistics">Calculating Column Statistics</h3>
<p>Aggregate functions summarize many data points (i.e., a column of a dataframe) into a smaller set of values.</p>
<p>Some examples of this type of calculation include.</p>
<p>The DataFrame customers contains the names and ages of all of your customers. You want to find the median age</p>
<pre><code>print(customers.age)
[23, 25, 31, 35, 35, 46, 62]
print(customers.age.median())
35</code></pre>
<p>The DataFrame shipments contains address information for all shipments that you’ve sent out in the past year. You want to know how many different states you have shipped to (and how many shipments went to the same state).</p>
<pre><code>print(shipments.state)
 ['CA', 'CA', 'CA', 'CA', 'NY', 'NY', 'NJ', 'NJ', 'NJ', 'NJ', 'NJ', 'NJ', 'NJ']
print(shipments.state.nunique())
3</code></pre>
<p>The DataFrame inventory contains a list of types of t-shirts that your company makes. You want a list of the colors that your shirts come in.</p>
<pre><code>print(inventory.color)
['blue', 'blue', 'blue', 'blue', 'blue', 'green', 'green', 'orange', 'orange', 'orange']
print(inventory.color.unique())
['blue', 'green', 'orange']</code></pre>
<p>The general syntax for these calculations is:</p>
<pre><code>df.column_name.command()</code></pre>
<p>The following table summarizes some common commands:</p>
<pre><code>Command Description
mean    Average of all values in column
std Standard deviation
median  Median
max Maximum value in column
min Minimum value in column
count   Number of values in column
nunique Number of unique values in column
unique  List of unique values in column</code></pre>
<div class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>orders <span class="op">=</span> pd.read_csv(<span class="st">'data/orders_price.csv'</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>orders.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">last_name</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_material</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
<th data-quarto-table-cell-role="th">price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>97916</td>
<td>Douglas</td>
<td>Perez</td>
<td>DouglasPerez28@gmail.com</td>
<td>stilettos</td>
<td>fabric</td>
<td>brown</td>
<td>90</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>67691</td>
<td>Tiffany</td>
<td>O'neill</td>
<td>TiffanyO'neill51@gmail.com</td>
<td>wedges</td>
<td>leather</td>
<td>navy</td>
<td>94</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>72818</td>
<td>Susan</td>
<td>Rivas</td>
<td>Susan.Rivas@gmail.com</td>
<td>sandals</td>
<td>faux-leather</td>
<td>white</td>
<td>96</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>28080</td>
<td>Angela</td>
<td>Hopper</td>
<td>AngelaHopper62@outlook.com</td>
<td>stilettos</td>
<td>leather</td>
<td>red</td>
<td>96</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>89958</td>
<td>Thomas</td>
<td>Benjamin</td>
<td>TBenjamin1981@gmail.com</td>
<td>sandals</td>
<td>faux-leather</td>
<td>navy</td>
<td>97</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>11853</td>
<td>Jonathan</td>
<td>Park</td>
<td>JP1285@gmail.com</td>
<td>wedges</td>
<td>fabric</td>
<td>white</td>
<td>98</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>73682</td>
<td>Christine</td>
<td>Adkins</td>
<td>ChristineAdkins83@gmail.com</td>
<td>stilettos</td>
<td>faux-leather</td>
<td>red</td>
<td>99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>52634</td>
<td>Cynthia</td>
<td>Tanner</td>
<td>CTanner1976@gmail.com</td>
<td>stilettos</td>
<td>faux-leather</td>
<td>navy</td>
<td>99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>33847</td>
<td>Walter</td>
<td>Fitzgerald</td>
<td>WalterFitzgerald65@gmail.com</td>
<td>ballet flats</td>
<td>leather</td>
<td>white</td>
<td>101</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>25964</td>
<td>Carl</td>
<td>Garcia</td>
<td>CarlGarcia53@gmail.com</td>
<td>wedges</td>
<td>faux-leather</td>
<td>white</td>
<td>101</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Our finance department wants to know the price of the most expensive pair of shoes purchased. Save your answer to the variable most_expensive.</p>
</blockquote>
<div class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>most_expensive <span class="op">=</span> orders.price.<span class="bu">max</span>()</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>most_expensive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="136">
<pre><code>498</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Our fashion department wants to know how many different colors of shoes we are selling. Save your answer to the variable num_colors.</p>
</blockquote>
<div class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>num_colors <span class="op">=</span> orders.shoe_color.nunique()</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>num_colors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>5</code></pre>
</div>
</div>
</section>
<section id="calculating-aggregate-functions-i" class="level3">
<h3 class="anchored" data-anchor-id="calculating-aggregate-functions-i">Calculating Aggregate Functions I</h3>
<p>When we have a bunch of data, we often want to calculate aggregate statistics (mean, standard deviation, median, percentiles, etc.) over certain subsets of the data.</p>
<p>Suppose we have a grade book with columns student, assignment_name, and grade.</p>
<p>We want to get an average grade for each student across all assignments. We could do some sort of loop, but Pandas gives us a much easier option: the method .groupby.</p>
<p>For this example, we’d use the following command:</p>
<pre><code>grades = df.groupby('student').grade.mean()</code></pre>
<p>In general, we use the following syntax to calculate aggregates:</p>
<pre><code>df.groupby('column1').column2.measurement()</code></pre>
<p>where:</p>
<ul>
<li>column1 is the column that we want to group by (‘student’ in our example)</li>
<li>column2 is the column that we want to perform a measurement on (grade in our example)</li>
<li>measurement is the measurement function we want to apply (mean in our example)</li>
</ul>
<p>For more on the groupby method, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html#pandas.DataFrame.groupby">review the pandas documentation</a>.</p>
<blockquote class="blockquote">
<p>Q. In the previous exercise, our finance department wanted to know the most expensive shoe that we sold. Now, they want to know the most expensive shoe for each shoe_type (i.e., the most expensive boot, the most expensive ballet flat, etc.). Save your answer to the variable pricey_shoes.</p>
</blockquote>
<div class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>pricey_shoes <span class="op">=</span> orders.groupby(<span class="st">'shoe_type'</span>).price.<span class="bu">max</span>()</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>pricey_shoes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">
<pre><code>shoe_type
ballet flats    498
sandals         498
stilettos       468
wedges          488
Name: price, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(pricey_shoes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.series.Series'&gt;</code></pre>
</div>
</div>
</section>
<section id="calculating-aggregate-functions-ii" class="level3">
<h3 class="anchored" data-anchor-id="calculating-aggregate-functions-ii">Calculating Aggregate Functions II</h3>
<p>After using groupby, we often need to clean our resulting data.</p>
<p>As we saw in the previous exercise, the groupby function creates a new Series, not a DataFrame. For our ShoeFly.com example, the indices of the Series were different values of shoe_type, and the name property was price.</p>
<p>Usually, we’d prefer that those indices were actually a column. In order to get that, we can use reset_index(). This will transform our Series into a DataFrame and move the indices into their own column.</p>
<p>Generally, you’ll always see a groupby statement followed by reset_index:</p>
<pre><code>df.groupby('column1').column2.measurement()
.reset_index()</code></pre>
<p>When we use groupby, we often want to rename the column we get as a result. For example, suppose we have a DataFrame teas containing data on types of tea. We want to find the number of each category of tea we sell. We can use:</p>
<pre><code>teas_counts = teas.groupby('category').id.count().reset_index()</code></pre>
<p>The new column contains the counts of each category of tea sold. We have 3 black teas, 4 green teas, and so on. However, this column is called id because we used the id column of teas to calculate the counts. We actually want to call this column counts. Remember that we can rename columns:</p>
<pre><code>teas_counts = teas_counts.rename(columns={"id": "counts"})</code></pre>
<div class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>pricey_shoes <span class="op">=</span> orders.groupby(<span class="st">'shoe_type'</span>).price.<span class="bu">max</span>().reset_index() <span class="co"># this converts from Series to DataFrame</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>pricey_shoes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ballet flats</td>
<td>498</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>sandals</td>
<td>498</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>stilettos</td>
<td>468</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>wedges</td>
<td>488</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(pricey_shoes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
</section>
<section id="calculating-aggregate-functions-iii" class="level3">
<h3 class="anchored" data-anchor-id="calculating-aggregate-functions-iii">Calculating Aggregate Functions III</h3>
<p>Sometimes, the operation that you want to perform is more complicated than mean or count. In those cases, you can use the apply method and lambda functions, just like we did for individual column operations. Note that the input to our lambda function will always be a list of values.</p>
<p>A great example of this is calculating percentiles. Suppose we have a DataFrame of employee information called df that has the following columns:</p>
<ul>
<li>id: the employee’s id number</li>
<li>name: the employee’s name</li>
<li>wage: the employee’s hourly wage</li>
<li>category: the type of work that the employee does</li>
</ul>
<p>Our data might look something like this:</p>
<pre><code>id  name    wage    category
10131   Sarah Carney    39  product
14189   Heather Carey   17  design
15004   Gary Mercado    33  marketing
11204   Cora Copaz  27  design</code></pre>
<p>If we want to calculate the 75th percentile (i.e., the point at which 75% of employees have a lower wage and 25% have a higher wage) for each category, we can use the following combination of apply and a lambda function</p>
<pre><code># np.percentile can calculate any percentile over an array of values
high_earners = df.groupby('category').wage
.apply(lambda x: np.percentile(x, 75))
.reset_index()</code></pre>
<blockquote class="blockquote">
<p>Q. Once more, we’ll return to the data from ShoeFly.com. Our Marketing team says that it’s important to have some affordably priced shoes available for every color of shoe that we sell. Let’s calculate the 25th percentile for shoe price for each shoe_color to help Marketing decide if we have enough cheap shoes on sale. Save the data to the variable cheap_shoes.</p>
</blockquote>
<div class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>cheap_shoes <span class="op">=</span> orders.groupby(<span class="st">'shoe_color'</span>).price.<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.percentile(x, <span class="dv">25</span>)).reset_index()</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>cheap_shoes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">shoe_color</th>
<th data-quarto-table-cell-role="th">price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>black</td>
<td>130.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>brown</td>
<td>248.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>navy</td>
<td>200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>red</td>
<td>157.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>white</td>
<td>188.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="calculating-aggregate-functions-iv" class="level3">
<h3 class="anchored" data-anchor-id="calculating-aggregate-functions-iv">Calculating Aggregate Functions IV</h3>
<p>Sometimes, we want to group by more than one column. We can easily do this by passing a list of column names into the groupby method.</p>
<p>Imagine that we run a chain of stores and have data about the number of sales at different locations on different days:</p>
<pre><code>Location    Date    Day of Week Total Sales
West Village    February 1  W   400
West Village    February 2  Th  450
Chelsea February 1  W   375
Chelsea February 2  Th  390</code></pre>
<p>We suspect that sales are different at different locations on different days of the week. In order to test this hypothesis, we could calculate the average sales for each store on each day of the week across multiple months. The code would look like this:</p>
<pre><code>df.groupby(['Location', 'Day of Week'])['Total Sales'].mean().reset_index()</code></pre>
<blockquote class="blockquote">
<p>Q. At ShoeFly.com, our Purchasing team thinks that certain shoe_type/shoe_color combinations are particularly popular this year (for example, blue ballet flats are all the rage in Paris). Create a DataFrame with the total number of shoes of each shoe_type/shoe_color combination purchased. Save it to the variable shoe_counts. You should be able to do this using groupby and count().</p>
</blockquote>
<blockquote class="blockquote">
<p>Note: When we’re using count(), it doesn’t really matter which column we perform the calculation on. You should use id in this example, but we would get the same answer if we used shoe_type or last_name.</p>
</blockquote>
<div class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>shoe_counts <span class="op">=</span> orders.groupby([<span class="st">'shoe_type'</span>, <span class="st">'shoe_color'</span>])[<span class="st">'id'</span>].count().reset_index()</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>shoe_counts.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
<th data-quarto-table-cell-role="th">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ballet flats</td>
<td>black</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ballet flats</td>
<td>brown</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>ballet flats</td>
<td>navy</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>ballet flats</td>
<td>red</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ballet flats</td>
<td>white</td>
<td>7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>shoe_counts <span class="op">=</span> shoe_counts.rename(columns<span class="op">=</span>{<span class="st">"id"</span>: <span class="st">"counts"</span>})</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>shoe_counts.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
<th data-quarto-table-cell-role="th">counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ballet flats</td>
<td>black</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ballet flats</td>
<td>brown</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>ballet flats</td>
<td>navy</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>ballet flats</td>
<td>red</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ballet flats</td>
<td>white</td>
<td>7</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="pivot-tables" class="level3">
<h3 class="anchored" data-anchor-id="pivot-tables">Pivot Tables</h3>
<p>When we perform a groupby across multiple columns, we often want to change how our data is stored. For instance, recall the example where we are running a chain of stores and have data about the number of sales at different locations on different days:</p>
<pre><code>Location    Date    Day of Week Total Sales
West Village    February 1  W   400
West Village    February 2  Th  450
Chelsea February 1  W   375
Chelsea February 2  Th  390</code></pre>
<p>We suspected that there might be different sales on different days of the week at different stores, so we performed a <code>groupby</code> across two different columns (<code>Location</code> and <code>Day of Week</code>). This gave us results that looked like this:</p>
<pre><code>Location    Day of Week Total Sales
Chelsea M   300
Chelsea Tu  310
Chelsea W   375
Chelsea Th  390
…       
West Village    Th  450
West Village    F   390
West Village    Sa  250</code></pre>
<p>In order to test our hypothesis, it would be more useful if the table was formatted like this:</p>
<pre><code>Location    M   Tu  W   Th  F   Sa  Su
Chelsea 300 310 375 390 300 150 175
West Village    300 310 400 450 390 250 200
…</code></pre>
<p>Reorganizing a table in this way is called pivoting. The new table is called a pivot table.</p>
<p>In Pandas, the command for pivot is:</p>
<pre><code>df.pivot(columns='ColumnToPivot',
     index='ColumnToBeRows',
     values='ColumnToBeValues')</code></pre>
<p>For our specific example, we would write the command like this:</p>
<pre><code># First use the groupby statement:
unpivoted = df.groupby(['Location', 'Day of Week'])['Total Sales'].mean().reset_index()

# Now pivot the table
pivoted = unpivoted.pivot(
columns='Day of Week',
index='Location',
values='Total Sales')</code></pre>
<p>Just like with groupby, the output of a pivot command is a new DataFrame, but the indexing tends to be “weird”, so we usually follow up with .reset_index().</p>
<blockquote class="blockquote">
<p>Q. n the previous example, you created a DataFrame with the total number of shoes of each shoe_type/shoe_color combination purchased for ShoeFly.com.The purchasing manager complains that this DataFrame is confusing. Make it easier for her to compare purchases of different shoe colors of the same shoe type by creating a pivot table. Save your results to the variable shoe_counts_pivot.</p>
</blockquote>
<div class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>shoe_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">shoe_color</th>
<th data-quarto-table-cell-role="th">counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ballet flats</td>
<td>black</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>ballet flats</td>
<td>brown</td>
<td>11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>ballet flats</td>
<td>navy</td>
<td>17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>ballet flats</td>
<td>red</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ballet flats</td>
<td>white</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>sandals</td>
<td>black</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>sandals</td>
<td>brown</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>sandals</td>
<td>navy</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>sandals</td>
<td>red</td>
<td>14</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>sandals</td>
<td>white</td>
<td>10</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>stilettos</td>
<td>black</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>stilettos</td>
<td>brown</td>
<td>14</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>stilettos</td>
<td>navy</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>stilettos</td>
<td>red</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>stilettos</td>
<td>white</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>wedges</td>
<td>brown</td>
<td>13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>wedges</td>
<td>navy</td>
<td>16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>wedges</td>
<td>red</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>wedges</td>
<td>white</td>
<td>17</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>shoe_counts_pivot <span class="op">=</span> shoe_counts.pivot(columns<span class="op">=</span><span class="st">'shoe_color'</span>, index<span class="op">=</span><span class="st">'shoe_type'</span>, values<span class="op">=</span><span class="st">'counts'</span>).reset_index()</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>shoe_counts_pivot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">shoe_color</th>
<th data-quarto-table-cell-role="th">shoe_type</th>
<th data-quarto-table-cell-role="th">black</th>
<th data-quarto-table-cell-role="th">brown</th>
<th data-quarto-table-cell-role="th">navy</th>
<th data-quarto-table-cell-role="th">red</th>
<th data-quarto-table-cell-role="th">white</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>ballet flats</td>
<td>2.0</td>
<td>11.0</td>
<td>17.0</td>
<td>13.0</td>
<td>7.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>sandals</td>
<td>3.0</td>
<td>10.0</td>
<td>13.0</td>
<td>14.0</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>stilettos</td>
<td>8.0</td>
<td>14.0</td>
<td>7.0</td>
<td>16.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>wedges</td>
<td>NaN</td>
<td>13.0</td>
<td>16.0</td>
<td>4.0</td>
<td>17.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="review" class="level3">
<h3 class="anchored" data-anchor-id="review">Review</h3>
<div class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>user_visits <span class="op">=</span> pd.read_csv(<span class="st">'data/page_visits.csv'</span>)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>user_visits.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="151">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">first_name</th>
<th data-quarto-table-cell-role="th">last_name</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">utm_source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10043</td>
<td>Louis</td>
<td>Koch</td>
<td>LouisKoch43@gmail.com</td>
<td>03-Mar</td>
<td>yahoo</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10150</td>
<td>Bruce</td>
<td>Webb</td>
<td>BruceWebb44@outlook.com</td>
<td>03-Mar</td>
<td>twitter</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>10155</td>
<td>Nicholas</td>
<td>Hoffman</td>
<td>Nicholas.Hoffman@gmail.com</td>
<td>02-Feb</td>
<td>google</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>10178</td>
<td>William</td>
<td>Key</td>
<td>William.Key@outlook.com</td>
<td>03-Mar</td>
<td>yahoo</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>10208</td>
<td>Karen</td>
<td>Bass</td>
<td>KB4971@gmail.com</td>
<td>02-Feb</td>
<td>google</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. The column utm_source contains information about how users got to ShoeFly’s homepage. For instance, if utm_source = Facebook, then the user came to ShoeFly by clicking on an ad on Facebook.com.Use a groupby statement to calculate how many visits came from each of the different sources. Save your answer to the variable click_source. Remember to use reset_index()!</p>
</blockquote>
<div class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>click_source <span class="op">=</span> user_visits.groupby(<span class="st">'utm_source'</span>)[<span class="st">'id'</span>].count().reset_index()</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>click_source</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="155">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">utm_source</th>
<th data-quarto-table-cell-role="th">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>email</td>
<td>462</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>facebook</td>
<td>823</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>google</td>
<td>543</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>twitter</td>
<td>415</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>yahoo</td>
<td>757</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Our Marketing department thinks that the traffic to our site has been changing over the past few months. Use groupby to calculate the number of visits to our site from each utm_source for each month. Save your answer to the variable <code>click_source_by_month</code>.</p>
</blockquote>
<div class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>click_source_by_month <span class="op">=</span> user_visits.groupby([<span class="st">'utm_source'</span>, <span class="st">'month'</span>])[<span class="st">'id'</span>].count().reset_index()</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>click_source_by_month</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">utm_source</th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>email</td>
<td>01-Jan</td>
<td>43</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>email</td>
<td>02-Feb</td>
<td>147</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>email</td>
<td>03-Mar</td>
<td>272</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>facebook</td>
<td>01-Jan</td>
<td>404</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>facebook</td>
<td>02-Feb</td>
<td>263</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>facebook</td>
<td>03-Mar</td>
<td>156</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>google</td>
<td>01-Jan</td>
<td>127</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>google</td>
<td>02-Feb</td>
<td>196</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>google</td>
<td>03-Mar</td>
<td>220</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>twitter</td>
<td>01-Jan</td>
<td>164</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>twitter</td>
<td>02-Feb</td>
<td>154</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>twitter</td>
<td>03-Mar</td>
<td>97</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>yahoo</td>
<td>01-Jan</td>
<td>262</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>yahoo</td>
<td>02-Feb</td>
<td>240</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>yahoo</td>
<td>03-Mar</td>
<td>255</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. The head of Marketing is complaining that this table is hard to read. Use pivot to create a pivot table where the rows are utm_source and the columns are month. Save your results to the variable <code>click_source_by_month_pivot</code>.</p>
</blockquote>
<div class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>click_source_by_month_pivot <span class="op">=</span> click_source_by_month.pivot(columns<span class="op">=</span><span class="st">'month'</span> , index<span class="op">=</span><span class="st">'utm_source'</span> , values<span class="op">=</span><span class="st">'id'</span>).reset_index()</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>click_source_by_month_pivot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">utm_source</th>
<th data-quarto-table-cell-role="th">01-Jan</th>
<th data-quarto-table-cell-role="th">02-Feb</th>
<th data-quarto-table-cell-role="th">03-Mar</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>email</td>
<td>43</td>
<td>147</td>
<td>272</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>facebook</td>
<td>404</td>
<td>263</td>
<td>156</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>google</td>
<td>127</td>
<td>196</td>
<td>220</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>twitter</td>
<td>164</td>
<td>154</td>
<td>97</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>yahoo</td>
<td>262</td>
<td>240</td>
<td>255</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>